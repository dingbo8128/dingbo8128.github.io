<!doctype html>
<html class="docs-version-current" lang="cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TDengine 文档 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TDengine 文档 Atom Feed"><title data-rh="true">数据查询 | TDengine 文档</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.taosdata.com/reference/taos-sql/select"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="keywords" content="TDengine, IoT"><meta data-rh="true" property="og:title" content="数据查询 | TDengine 文档"><meta data-rh="true" name="description" content="查询语法"><meta data-rh="true" property="og:description" content="查询语法"><link data-rh="true" rel="icon" href="/img/tdengine.ico"><link data-rh="true" rel="canonical" href="https://docs.taosdata.com/reference/taos-sql/select"><link data-rh="true" rel="alternate" href="https://docs.taosdata.com/reference/taos-sql/select" hreflang="cn"><link data-rh="true" rel="alternate" href="https://docs.taosdata.com/reference/taos-sql/select" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d3d1b57a.css">
<link rel="preload" href="/assets/js/runtime~main.d597a18b.js" as="script">
<link rel="preload" href="/assets/js/main.5a80987c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.taosdata.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/site-logo.png" alt="TDengine 文档" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/site-logo.png" alt="TDengine 文档" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/get-started">快速上手</a><a href="https://www.taosdata.com/products" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">产品</a><a class="navbar__item navbar__link navbar__link--active" href="/intro/">文档</a><a href="https://www.taosdata.com/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">博客</a><a href="https://www.taosdata.com/media" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">媒体</a><a href="https://www.taosdata.com/support" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">技术支持</a><a href="https://www.taosdata.com/s" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">搜索</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link languageDropdown"> </a><ul class="dropdown__menu"><li><a href="https://www.taosdata.com/docs" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>中文<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://tdengine.com/docs/en/v2.0/index" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>English<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_gi4H"><div class="sidebarTop_Qw2W"><div class="versionDropdownWrapper_Qxj6"><select name="version" class="versionSelect_lz6N"><option value="v2.x">v2.4</option><option value="v1.6">v1.6</option></select></div><div class="searchBar_Xj6T"><input><label class="iconLabel_Oh1n"><svg width="20" height="20" class="searchIcon_fLua" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg></label></div></div><nav class="menu thin-scrollbar menu_PfFV"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intro/">产品简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/concept/">基本概念</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/get-started/">立即开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/connect/">建立连接</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/model/">数据建模</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/写入数据">写入数据</a><button aria-label="Toggle the collapsible sidebar category &#x27;写入数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/query-data/">查询数据</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/advance-feature/">高级功能</a><button aria-label="Toggle the collapsible sidebar category &#x27;高级功能&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/third-party/">与第三方工具集成</a><button aria-label="Toggle the collapsible sidebar category &#x27;与第三方工具集成&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/集群">集群</a><button aria-label="Toggle the collapsible sidebar category &#x27;集群&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/运维指南">运维指南</a><button aria-label="Toggle the collapsible sidebar category &#x27;运维指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/技术内幕">技术内幕</a><button aria-label="Toggle the collapsible sidebar category &#x27;技术内幕&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/category/参考指南">参考指南</a><button aria-label="Toggle the collapsible sidebar category &#x27;参考指南&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/reference/taos-sql/">TAOS SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;TAOS SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/data-type">支持的数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/database">数据库管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/table">表管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/stable">超级表管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/insert">数据写入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/taos-sql/select">数据查询</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/function">SQL 函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/interval">按窗口切分聚合</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/limit">边界限制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/json">JSON 类型使用说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/escape">转义字符说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/taos-sql/errorcode">错误码</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/connector/">连接器</a><button aria-label="Toggle the collapsible sidebar category &#x27;连接器&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/category/组件和工具">组件和工具</a><button aria-label="Toggle the collapsible sidebar category &#x27;组件和工具&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/direcotry">文件目录结构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/support-platform/">支持平台列表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/keywords">参数限制与保留关键字</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/docker">TDengine Docker 镜像</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/应用实践">应用实践</a><button aria-label="Toggle the collapsible sidebar category &#x27;应用实践&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/物联网大数据">物联网大数据</a><button aria-label="Toggle the collapsible sidebar category &#x27;物联网大数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/category/faq教程及其它">FAQ、教程及其它</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ、教程及其它&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>数据查询</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="查询语法">查询语法<a class="hash-link" href="#查询语法" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT select_expr [, select_expr ...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM {tb_name_list}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [WHERE where_condition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [SESSION(ts_col, tol_val)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [STATE_WINDOW(col)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [INTERVAL(interval_val [, interval_offset]) [SLIDING sliding_val]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FILL(fill_mod_and_val)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [GROUP BY col_list]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ORDER BY col_list { DESC | ASC }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [SLIMIT limit_val [SOFFSET offset_val]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [LIMIT limit_val [OFFSET offset_val]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [&gt;&gt; export_file];</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="通配符">通配符<a class="hash-link" href="#通配符" title="Direct link to heading">​</a></h2><p>通配符 <!-- -->*<!-- --> 可以用于代指全部列。对于普通表，结果中只有普通列。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT * FROM d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ts            |       current        |   voltage   |        phase         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 |             10.30000 |         219 |              0.31000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:15.000 |             12.60000 |         218 |              0.33000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:16.800 |             12.30000 |         221 |              0.31000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 3 row(s) in set (0.001165s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在针对超级表，通配符包含 <em>标签列</em> 。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT * FROM meters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ts            |       current        |   voltage   |        phase         |            location            |   groupid   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.500 |             11.80000 |         221 |              0.28000 | Beijing.Haidian                |           2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:16.600 |             13.40000 |         223 |              0.29000 | Beijing.Haidian                |           2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 |             10.80000 |         223 |              0.29000 | Beijing.Haidian                |           3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:06.500 |             11.50000 |         221 |              0.35000 | Beijing.Haidian                |           3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:04.000 |             10.20000 |         220 |              0.23000 | Beijing.Chaoyang               |           3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:16.650 |             10.30000 |         218 |              0.25000 | Beijing.Chaoyang               |           3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 |             10.30000 |         219 |              0.31000 | Beijing.Chaoyang               |           2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:15.000 |             12.60000 |         218 |              0.33000 | Beijing.Chaoyang               |           2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:16.800 |             12.30000 |         221 |              0.31000 | Beijing.Chaoyang               |           2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 9 row(s) in set (0.002022s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>通配符支持表名前缀，以下两个 SQL 语句均为返回全部的列：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT d1001.* FROM d1001;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在 JOIN 查询中，带前缀的<!-- -->*<!-- -->和不带前缀<!-- -->*<!-- -->返回的结果有差别， <!-- -->*<!-- -->返回全部表的所有列数据（不包含标签），带前缀的通配符，则只返回该表的列数据。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT * FROM d1001, d1003 WHERE d1001.ts=d1003.ts;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ts            | current |   voltage   |    phase     |           ts            | current |   voltage   |    phase     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================================================================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 | 10.30000|         219 |      0.31000 | 2018-10-03 14:38:05.000 | 10.80000|         223 |      0.29000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.017385s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT d1001.* FROM d1001,d1003 WHERE d1001.ts = d1003.ts;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ts            |       current        |   voltage   |        phase         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 |             10.30000 |         219 |              0.31000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.020443s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在使用 SQL 函数来进行查询的过程中，部分 SQL 函数支持通配符操作。其中的区别在于：
<code>count(*)</code>函数只返回一列。<code>first</code>、<code>last</code>、<code>last_row</code>函数则是返回全部列。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT COUNT(*) FROM d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       count(*)        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.001035s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT FIRST(*) FROM d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        first(ts)        |    first(current)    | first(voltage) |     first(phase)     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=========================================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 |             10.30000 |            219 |              0.31000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000849s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="标签列">标签列<a class="hash-link" href="#标签列" title="Direct link to heading">​</a></h2><p>从 2.0.14 版本开始，支持在普通表的查询中指定 <em>标签列</em>，且标签列的值会与普通列的数据一起返回。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT location, groupid, current FROM d1001 LIMIT 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location            |   groupid   |       current        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Beijing.Chaoyang               |           2 |             10.30000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Beijing.Chaoyang               |           2 |             12.60000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 2 row(s) in set (0.003112s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>注意：普通表的通配符 <!-- -->*<!-- --> 中并不包含 <em>标签列</em>。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="获取标签列或普通列的去重取值">获取标签列或普通列的去重取值<a class="hash-link" href="#获取标签列或普通列的去重取值" title="Direct link to heading">​</a></h2><p>从 2.0.15.0 版本开始，支持在超级表查询标签列时，指定 DISTINCT 关键字，这样将返回指定标签列的所有不重复取值。注意，在 2.1.6.0 版本之前，DISTINCT 只支持处理单个标签列，而从 2.1.6.0 版本开始，DISTINCT 可以对多个标签列进行处理，输出这些标签列取值不重复的组合。</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> tag_name </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tag_name </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> stb_name</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>从 2.1.7.0 版本开始，DISTINCT 也支持对数据子表或普通表进行处理，也即支持获取单个普通列的不重复取值，或多个普通列取值的不重复组合。</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> col_name </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> col_name </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> tb_name</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><ol><li>cfg 文件中的配置参数 maxNumOfDistinctRes 将对 DISTINCT 能够输出的数据行数进行限制。其最小值是 100000，最大值是 100000000，默认值是 10000000。如果实际计算结果超出了这个限制，那么会仅输出这个数量范围内的部分。</li><li>由于浮点数天然的精度机制原因，在特定情况下，对 FLOAT 和 DOUBLE 列使用 DISTINCT 并不能保证输出值的完全唯一性。</li><li>在当前版本下，DISTINCT 不能在嵌套查询的子查询中使用，也不能与聚合函数、GROUP BY、或 JOIN 在同一条语句中混用。</li></ol></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="结果集列名">结果集列名<a class="hash-link" href="#结果集列名" title="Direct link to heading">​</a></h2><p><code>SELECT</code>子句中，如果不指定返回结果集合的列名，结果集列名称默认使用<code>SELECT</code>子句中的表达式名称作为列名称。此外，用户可使用<code>AS</code>来重命名返回结果集合中列的名称。例如：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT ts, ts AS primary_key_ts FROM d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ts            |     primary_key_ts      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:05.000 | 2018-10-03 14:38:05.000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:15.000 | 2018-10-03 14:38:15.000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2018-10-03 14:38:16.800 | 2018-10-03 14:38:16.800 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 3 row(s) in set (0.001191s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>但是针对<code>first(*)</code>、<code>last(*)</code>、<code>last_row(*)</code>不支持针对单列的重命名。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="隐式结果列">隐式结果列<a class="hash-link" href="#隐式结果列" title="Direct link to heading">​</a></h2><p><code>Select_exprs</code>可以是表所属列的列名，也可以是基于列的函数表达式或计算式，数量的上限 256 个。当用户使用了<code>interval</code>或<code>group by tags</code>的子句以后，在最后返回结果中会强制返回时间戳列（第一列）和 group by 子句中的标签列。后续的版本中可以支持关闭 group by 子句中隐式列的输出，列输出完全由 select 子句控制。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="表超级表列表">表（超级表）列表<a class="hash-link" href="#表超级表列表" title="Direct link to heading">​</a></h2><p>FROM 关键字后面可以是若干个表（超级表）列表，也可以是子查询的结果。
如果没有指定用户的当前数据库，可以在表名称之前使用数据库的名称来指定表所属的数据库。例如：<code>power.d1001</code> 方式来跨库使用表。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM power.d1001;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USE power;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM d1001;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="特殊功能">特殊功能<a class="hash-link" href="#特殊功能" title="Direct link to heading">​</a></h2><p>部分特殊的查询功能可以不使用 FROM 子句执行。获取当前所在的数据库 database()：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT DATABASE();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           database()           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> power                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000079s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>如果登录的时候没有指定默认数据库，且没有使用<code>USE</code>命令切换数据，则返回 NULL。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT DATABASE();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           database()           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> NULL                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000184s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>获取服务器和客户端版本号：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT CLIENT_VERSION();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> client_version() |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2.0.0.0          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000070s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT SERVER_VERSION();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> server_version() |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2.0.0.0          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000077s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>服务器状态检测语句。如果服务器正常，返回一个数字（例如 1）。如果服务器异常，返回 error code。该 SQL 语法能兼容连接池对于 TDengine 状态的检查及第三方工具对于数据库服务器状态的检查。并可以避免出现使用了错误的心跳检测 SQL 语句导致的连接池连接丢失的问题。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT SERVER_STATUS();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> server_status() |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000074s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT SERVER_STATUS() AS status;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   status    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==============</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.000081s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="_block_dist-函数">_<!-- -->block_dist 函数<a class="hash-link" href="#_block_dist-函数" title="Direct link to heading">​</a></h2><p>用于获得指定的（超级）表的数据块分布信息</p><div class="codeBlockContainer_I0IT language-txt theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">语法</div><div class="codeBlockContent_wNvx txt"><pre tabindex="0" class="prism-code language-txt codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT _block_dist() FROM { tb_name | stb_name }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>返回结果类型：字符串。</p><p>适用数据类型：不能输入任何参数。</p><p>嵌套子查询支持：不支持子查询或嵌套查询。</p><p>返回 FROM 子句中输入的表或超级表的数据块分布情况。不支持查询条件。</p><p>返回的结果是该表或超级表的数据块所包含的行数的数据分布直方图。</p><div class="codeBlockContainer_I0IT language-txt theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">返回结果</div><div class="codeBlockContent_wNvx txt"><pre tabindex="0" class="prism-code language-txt codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">summary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5th=[392], 10th=[392], 20th=[392], 30th=[392], 40th=[792], 50th=[792] 60th=[792], 70th=[792], 80th=[792], 90th=[792], 95th=[792], 99th=[792] Min=[392(Rows)] Max=[800(Rows)] Avg=[666(Rows)] Stddev=[2.17] Rows=[2000], Blocks=[3], Size=[5.440(Kb)] Comp=[0.23] RowsInMem=[0] SeekHeaderTime=[1(us)]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>上述信息的说明如下：</p><ol><li>查询的（超级）表所包含的存储在文件中的数据块（data block）中所包含的数据行的数量分布直方图信息：5%， 10%， 20%， 30%， 40%， 50%， 60%， 70%， 80%， 90%， 95%， 99% 的数值；</li><li>所有数据块中，包含行数最少的数据块所包含的行数量， 其中的 Min 指标 392 行。</li><li>所有数据块中，包含行数最多的数据块所包含的行数量， 其中的 Max 指标 800 行。</li><li>所有数据块行数的算数平均值 666 行（其中的 Avg 项）。</li><li>所有数据块中行数分布的均方差为 2.17 ( stddev ）。</li><li>数据块包含的行的总数为 2000 行（Rows）。</li><li>数据块总数是 3 个数据块 （Blocks）。</li><li>数据块占用磁盘空间大小 5.44 Kb （size）。</li><li>压缩后的数据块的大小除以原始数据的所获得的压缩比例： 23%（Comp），及压缩后的数据规模是原始数据规模的 23%。</li><li>内存中存在的数据行数是 0，表示内存中没有数据缓存。</li><li>获取数据块信息的过程中读取头文件的时间开销 1 微秒（SeekHeaderTime）。</li></ol><p>支持版本：指定计算算法的功能从 2.1.0.x 版本开始，2.1.0.0 之前的版本不支持指定使用算法的功能。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="taos-sql-中特殊关键词">TAOS SQL 中特殊关键词<a class="hash-link" href="#taos-sql-中特殊关键词" title="Direct link to heading">​</a></h2><ul><li><code>TBNAME</code>： 在超级表查询中可视为一个特殊的标签，代表查询涉及的子表名</li><li><code>_c0</code>: 表示表（超级表）的第一列</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="小技巧">小技巧<a class="hash-link" href="#小技巧" title="Direct link to heading">​</a></h2><p>获取一个超级表所有的子表名及相关的标签信息：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT TBNAME, location FROM meters;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>统计超级表下辖子表数量：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT COUNT(TBNAME) FROM meters;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>以上两个查询均只支持在 WHERE 条件子句中添加针对标签（TAGS）的过滤条件。例如：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT TBNAME, location FROM meters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             tbname             |            location            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d1004                          | Beijing.Haidian                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d1003                          | Beijing.Haidian                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d1002                          | Beijing.Chaoyang               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d1001                          | Beijing.Chaoyang               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 4 row(s) in set (0.000881s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taos&gt; SELECT COUNT(tbname) FROM meters WHERE groupId &gt; 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     count(tbname)     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     2 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK, 1 row(s) in set (0.001091s)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>可以使用 <!-- -->*<!-- --> 返回所有列，或指定列名。可以对数字列进行四则运算，可以给输出的列取列名。<ul><li>暂不支持含列名的四则运算表达式用于条件过滤算子（例如，不支持 <code>where a*2&gt;6;</code>，但可以写 <code>where a&gt;6/2;</code>）。</li><li>暂不支持含列名的四则运算表达式作为 SQL 函数的应用对象（例如，不支持 <code>select min(2*a) from t;</code>，但可以写 <code>select 2*min(a) from t;</code>）。</li></ul></li><li>WHERE 语句可以使用各种逻辑判断来过滤数字值，或使用通配符来过滤字符串。</li><li>输出结果缺省按首列时间戳升序排序，但可以指定按降序排序( <!-- -->_<!-- -->c0 指首列时间戳)。使用 ORDER BY 对其他字段进行排序,排序结果顺序不确定。</li><li>参数 LIMIT 控制输出条数，OFFSET 指定从第几条开始输出。LIMIT/OFFSET 对结果集的执行顺序在 ORDER BY 之后。且 <code>LIMIT 5 OFFSET 2</code> 可以简写为 <code>LIMIT 2, 5</code>。<ul><li>在有 GROUP BY 子句的情况下，LIMIT 参数控制的是每个分组中至多允许输出的条数。</li></ul></li><li>参数 SLIMIT 控制由 GROUP BY 指令划分的分组中，至多允许输出几个分组的数据。且 <code>SLIMIT 5 SOFFSET 2</code> 可以简写为 <code>SLIMIT 2, 5</code>。</li><li>通过 “&gt;&gt;” 输出结果可以导出到指定文件。</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="条件过滤操作">条件过滤操作<a class="hash-link" href="#条件过滤操作" title="Direct link to heading">​</a></h2><table><thead><tr><th><strong>Operation</strong></th><th><strong>Note</strong></th><th><strong>Applicable Data Types</strong></th></tr></thead><tbody><tr><td>&gt;</td><td>larger than</td><td>all types except bool</td></tr><tr><td>&lt;</td><td>smaller than</td><td>all types except bool</td></tr><tr><td>&gt;=</td><td>larger than or equal to</td><td>all types except bool</td></tr><tr><td>&lt;=</td><td>smaller than or equal to</td><td>all types except bool</td></tr><tr><td>=</td><td>equal to</td><td>all types</td></tr><tr><td>&lt;<!-- -->&gt;</td><td>not equal to</td><td>all types</td></tr><tr><td>is <!-- -->[not]<!-- --> null</td><td>is null or is not null</td><td>all types</td></tr><tr><td>between and</td><td>within a certain range</td><td>all types except bool</td></tr><tr><td>in</td><td>match any value in a set</td><td>all types except first column <code>timestamp</code></td></tr><tr><td>like</td><td>match a wildcard string</td><td><strong><code>binary</code></strong> <strong><code>nchar</code></strong></td></tr><tr><td>match/nmatch</td><td>filter regex</td><td><strong><code>binary</code></strong> <strong><code>nchar</code></strong></td></tr></tbody></table><ol><li>&lt;<!-- -->&gt;<!-- --> 算子也可以写为 != ，请注意，这个算子不能用于数据表第一列的 timestamp 字段。</li><li>like 算子使用通配符字符串进行匹配检查。<ul><li>在通配符字符串中：&#x27;%&#x27;（百分号）匹配 0 到任意个字符；&#x27;<!-- -->_<!-- -->&#x27;（下划线）匹配单个任意 ASCII 字符。</li><li>如果希望匹配字符串中原本就带有的 <!-- -->_<!-- -->（下划线）字符，那么可以在通配符字符串中写作 <code>\_</code>，也即加一个反斜线来进行转义。（从 2.2.0.0 版本开始支持）</li><li>通配符字符串最长不能超过 20 字节。（从 2.1.6.1 版本开始，通配符字符串的长度放宽到了 100 字节，并可以通过 taos.cfg 中的 maxWildCardsLength 参数来配置这一长度限制。但不建议使用太长的通配符字符串，将有可能严重影响 LIKE 操作的执行性能。）</li></ul></li><li>同时进行多个字段的范围过滤，需要使用关键词 AND 来连接不同的查询条件，暂不支持 OR 连接的不同列之间的查询过滤条件。<ul><li>从 2.3.0.0 版本开始，已支持完整的同一列和/或不同列间的 AND/OR 运算。</li></ul></li><li>针对单一字段的过滤，如果是时间过滤条件，则一条语句中只支持设定一个；但针对其他的（普通）列或标签列，则可以使用 <code>OR</code> 关键字进行组合条件的查询过滤。例如： <code>((value &gt; 20 AND value &lt; 30) OR (value &lt; 12))</code>。<ul><li>从 2.3.0.0 版本开始，允许使用多个时间过滤条件，但首列时间戳的过滤运算结果只能包含一个区间。</li></ul></li><li>从 2.0.17.0 版本开始，条件过滤开始支持 BETWEEN AND 语法，例如 <code>WHERE col2 BETWEEN 1.5 AND 3.25</code> 表示查询条件为“1.5 ≤ col2 ≤ 3.25”。</li><li>从 2.1.4.0 版本开始，条件过滤开始支持 IN 算子，例如 <code>WHERE city IN (&#x27;Beijing&#x27;, &#x27;Shanghai&#x27;)</code>。说明：BOOL 类型写作 <code>{true, false}</code> 或 <code>{0, 1}</code> 均可，但不能写作 0、1 之外的整数；FLOAT 和 DOUBLE 类型会受到浮点数精度影响，集合内的值在精度范围内认为和数据行的值完全相等才能匹配成功；TIMESTAMP 类型支持非主键的列。</li><li>从 2.3.0.0 版本开始，条件过滤开始支持正则表达式，关键字 match/nmatch，不区分大小写。</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="正则表达式过滤">正则表达式过滤<a class="hash-link" href="#正则表达式过滤" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="语法">语法<a class="hash-link" href="#语法" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-txt theme-code-block"><div class="codeBlockContent_wNvx txt"><pre tabindex="0" class="prism-code language-txt codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">WHERE (column|tbname) **match/MATCH/nmatch/NMATCH** _regex_</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="正则表达式规范">正则表达式规范<a class="hash-link" href="#正则表达式规范" title="Direct link to heading">​</a></h3><p>确保使用的正则表达式符合 POSIX 的规范，具体规范内容可参见<a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html" target="_blank" rel="noopener noreferrer">Regular Expressions</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="使用限制">使用限制<a class="hash-link" href="#使用限制" title="Direct link to heading">​</a></h3><p>只能针对表名（即 tbname 筛选）、binary/nchar 类型标签值进行正则表达式过滤，不支持普通列的过滤。</p><p>正则匹配字符串长度不能超过 128 字节。可以通过参数 <em>maxRegexStringLen</em> 设置和调整最大允许的正则匹配字符串，该参数是客户端配置参数，需要重启才能生效。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="join-子句">JOIN 子句<a class="hash-link" href="#join-子句" title="Direct link to heading">​</a></h2><p>从 2.2.0.0 版本开始，TDengine 对内连接（INNER JOIN）中的自然连接（Natural join）操作实现了完整的支持。也即支持“普通表与普通表之间”、“超级表与超级表之间”、“子查询与子查询之间”进行自然连接。自然连接与内连接的主要区别是，自然连接要求参与连接的字段在不同的表/超级表中必须是同名字段。也即，TDengine 在连接关系的表达中，要求必须使用同名数据列/标签列的相等关系。</p><p>在普通表与普通表之间的 JOIN 操作中，只能使用主键时间戳之间的相等关系。例如：</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> temp_tb_1 t1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pressure_tb_1 t2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ts</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>在超级表与超级表之间的 JOIN 操作中，除了主键时间戳一致的条件外，还要求引入能实现一一对应的标签列的相等关系。例如：</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> temp_stable t1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temp_stable t2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ts </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deviceid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deviceid </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">status</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>类似地，也可以对多个子查询的查询结果进行 JOIN 操作。</p><p>注意，JOIN 操作存在如下限制要求：</p><ol><li>参与一条语句中 JOIN 操作的表/超级表最多可以有 10 个。</li><li>在包含 JOIN 操作的查询语句中不支持 FILL。</li><li>暂不支持参与 JOIN 操作的表之间聚合后的四则运算。</li><li>不支持只对其中一部分表做 GROUP BY。</li><li>JOIN 查询的不同表的过滤条件之间不能为 OR。</li><li>JOIN 查询要求连接条件不能是普通列，只能针对标签和主时间字段列（第一列）。</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="嵌套查询">嵌套查询<a class="hash-link" href="#嵌套查询" title="Direct link to heading">​</a></h2><p>“嵌套查询”又称为“子查询”，也即在一条 SQL 语句中，“内层查询”的计算结果可以作为“外层查询”的计算对象来使用。</p><p>从 2.2.0.0 版本开始，TDengine 的查询引擎开始支持在 FROM 子句中使用非关联子查询（“非关联”的意思是，子查询不会用到父查询中的参数）。也即在普通 SELECT 语句的 tb_name_list 位置，用一个独立的 SELECT 语句来代替（这一 SELECT 语句被包含在英文圆括号内），于是完整的嵌套查询 SQL 语句形如：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT ... FROM (SELECT ... FROM ...) ...;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><ol><li>目前仅支持一层嵌套，也即不能在子查询中再嵌入子查询。</li><li>内层查询的返回结果将作为“虚拟表”供外层查询使用，此虚拟表可以使用 AS 语法做重命名，以便于外层查询中方便引用。</li><li>目前不能在“连续查询”功能中使用子查询。</li><li>在内层和外层查询中，都支持普通的表间/超级表间 JOIN。内层查询的计算结果也可以再参与数据子表的 JOIN 操作。</li><li>目前内层查询、外层查询均不支持 UNION 操作。</li><li>内层查询支持的功能特性与非嵌套的查询语句能力是一致的。<ul><li>内层查询的 ORDER BY 子句一般没有意义，建议避免这样的写法以免无谓的资源消耗。</li></ul></li><li>与非嵌套的查询语句相比，外层查询所能支持的功能特性存在如下限制：<ul><li>计算函数部分：
<em>. 如果内层查询的结果数据未提供时间戳，那么计算过程依赖时间戳的函数在外层会无法正常工作。例如：TOP, BOTTOM, FIRST, LAST, DIFF。
</em>. 计算过程需要两遍扫描的函数，在外层查询中无法正常工作。例如：此类函数包括：STDDEV, PERCENTILE。</li><li>外层查询中不支持 IN 算子，但在内层中可以使用。</li><li>外层查询不支持 GROUP BY。</li></ul></li></ol></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="union-all-子句">UNION ALL 子句<a class="hash-link" href="#union-all-子句" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-txt theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">语法</div><div class="codeBlockContent_wNvx txt"><pre tabindex="0" class="prism-code language-txt codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UNION ALL SELECT ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[UNION ALL SELECT ...]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>TDengine 支持 UNION ALL 操作符。也就是说，如果多个 SELECT 子句返回结果集的结构完全相同（列名、列类型、列数、顺序），那么可以通过 UNION ALL 把这些结果集合并到一起。目前只支持 UNION ALL 模式，也即在结果集的合并过程中是不去重的。在同一个 sql 语句中，UNION ALL 最多支持 100 个。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="sql-示例">SQL 示例<a class="hash-link" href="#sql-示例" title="Direct link to heading">​</a></h3><p>对于下面的例子，表 tb1 用以下语句创建：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE tb1 (ts TIMESTAMP, col1 INT, col2 FLOAT, col3 BINARY(50));</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询 tb1 刚过去的一个小时的所有记录：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM tb1 WHERE ts &gt;= NOW - 1h;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询表 tb1 从 2018-06-01 08:00:00.000 到 2018-06-02 08:00:00.000 时间范围，并且 col3 的字符串是&#x27;nny&#x27;结尾的记录，结果按照时间戳降序：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM tb1 WHERE ts &gt; &#x27;2018-06-01 08:00:00.000&#x27; AND ts &lt;= &#x27;2018-06-02 08:00:00.000&#x27; AND col3 LIKE &#x27;%nny&#x27; ORDER BY ts DESC;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询 col1 与 col2 的和，并取名 complex, 时间大于 2018-06-01 08:00:00.000, col2 大于 1.2，结果输出仅仅 10 条记录，从第 5 条开始：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT (col1 + col2) AS &#x27;complex&#x27; FROM tb1 WHERE ts &gt; &#x27;2018-06-01 08:00:00.000&#x27; AND col2 &gt; 1.2 LIMIT 10 OFFSET 5;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询过去 10 分钟的记录，col2 的值大于 3.14，并且将结果输出到文件 <code>/home/testoutpu.csv</code>：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT COUNT(*) FROM tb1 WHERE ts &gt;= NOW - 10m AND col2 &gt; 3.14 &gt;&gt; /home/testoutpu.csv;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="feedback_CILg"><h4>支持和反馈</h4><p>感谢您成为我们社区的一员！欢迎您对本文档或其他任何 TDengine错误进行修改或报告。</p><div><a href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener">编辑本文档</a>  | <a href="https://github.com/taosdata/TDengine/issues/new/choose" target="_blank" rel="noopener">反馈问题</a>  | <a href="" class="advice">获取专业服务</a></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/reference/taos-sql/insert"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">数据写入</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/reference/taos-sql/function"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SQL 函数</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#查询语法" class="table-of-contents__link toc-highlight">查询语法</a></li><li><a href="#通配符" class="table-of-contents__link toc-highlight">通配符</a></li><li><a href="#标签列" class="table-of-contents__link toc-highlight">标签列</a></li><li><a href="#获取标签列或普通列的去重取值" class="table-of-contents__link toc-highlight">获取标签列或普通列的去重取值</a></li><li><a href="#结果集列名" class="table-of-contents__link toc-highlight">结果集列名</a></li><li><a href="#隐式结果列" class="table-of-contents__link toc-highlight">隐式结果列</a></li><li><a href="#表超级表列表" class="table-of-contents__link toc-highlight">表（超级表）列表</a></li><li><a href="#特殊功能" class="table-of-contents__link toc-highlight">特殊功能</a></li><li><a href="#_block_dist-函数" class="table-of-contents__link toc-highlight">_block_dist 函数</a></li><li><a href="#taos-sql-中特殊关键词" class="table-of-contents__link toc-highlight">TAOS SQL 中特殊关键词</a></li><li><a href="#小技巧" class="table-of-contents__link toc-highlight">小技巧</a></li><li><a href="#条件过滤操作" class="table-of-contents__link toc-highlight">条件过滤操作</a></li><li><a href="#正则表达式过滤" class="table-of-contents__link toc-highlight">正则表达式过滤</a><ul><li><a href="#语法" class="table-of-contents__link toc-highlight">语法</a></li><li><a href="#正则表达式规范" class="table-of-contents__link toc-highlight">正则表达式规范</a></li><li><a href="#使用限制" class="table-of-contents__link toc-highlight">使用限制</a></li></ul></li><li><a href="#join-子句" class="table-of-contents__link toc-highlight">JOIN 子句</a></li><li><a href="#嵌套查询" class="table-of-contents__link toc-highlight">嵌套查询</a></li><li><a href="#union-all-子句" class="table-of-contents__link toc-highlight">UNION ALL 子句</a><ul><li><a href="#sql-示例" class="table-of-contents__link toc-highlight">SQL 示例</a></li></ul></li></ul></div></div></div></div></main></div></div><div class="footer_xBL4"><div class="container_pcGX"><div class="inside_k1Uh"><div class="top_Ap4P"><div class="left_ZN5n"><figure class="logo_fYHz"><img src="/assets/images/site-logo-bd7b8c0ea4bb9c0cd1a93fc1ec3105b1.png" class="logoImg_gUO0" width="100"></figure><div class="tdengine_eblt"><p>TDengine 是一款高性能、分布式、支持 SQL 的时序数据库，其核心代码包括集群功能全部开源，同时TDengine 还带有内建的缓存、流式计算、数据订阅等系统功能，能大幅减少研发和运维的复杂度，可广泛应用于物联网、车联网、工业互联网、IT运维、金融等领域。</p></div></div><div class="right_ClYX"><div class="sales_O9Qj"><span class="button_zS_t">联系销售</span></div><div class="social_uOzn"><span class="socialBtn_OKmL"> <span class="icon_VBv9"> <svg viewBox="0 0 576 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"> <path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z" fill="var(--white)"></path> </svg> </span> </span><a class="socialBtn_OKmL" href="https://weibo.com/u/6368262736" target="_blank" rel="noopener noreferrer" aria-label="twitter link"> <span class="icon_VBv9"> <svg viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"> <path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7 0 395.3 0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z" fill="var(--white)"></path> </svg> </span> </a><a class="socialBtn_OKmL" href="https://github.com/taosdata/TDengine" target="_blank" rel="noopener noreferrer" aria-label="facebook link"><span class="icon_VBv9"><svg viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9 1.4.3 2.6.4 3.8.4 8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1-8.4 1.9-15.9 2.7-22.6 2.7-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1 10.5 0 20-3.4 25.6-6 2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8 0 0 1.6-.5 5-.5 8.1 0 26.4 3.1 56.6 24.1 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 30.2-21 48.5-24.1 56.6-24.1 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5 1.2 0 2.6-.1 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"></path></svg></span></a><span class="socialBtn_OKmL" target="_blank" rel="noopener noreferrer" aria-label="twitter link"><span class="icon_VBv9"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1291 1024"><path fill="#ffffff" d="M781.793876 523.871639a229.106808 229.106808 0 0 0 88.712761-185.157367v-8.138785a230.327626 230.327626 0 0 0-225.444355-225.444355 230.327626 230.327626 0 0 0-225.851294 225.037416 240.908047 240.908047 0 0 0 88.712761 185.157367A348.746953 348.746953 0 0 0 282.479394 854.713264c8.138785 162.775707 153.009165 169.286736 354.444103 169.286736s354.444103 0 362.582888-169.286736c17.905328-145.684258-88.71276-274.684006-217.712509-330.841625z"></path><path fill="#ffffff" d="M403.340357 507.594069a290.554638 290.554638 0 0 1-48.425773-162.775708 284.857488 284.857488 0 0 1 81.387853-209.573723 228.29293 228.29293 0 0 1 88.712761-64.296404A203.469634 203.469634 0 0 0 363.053369 0.140801a225.037415 225.037415 0 0 0-225.444355 225.444355 240.908047 240.908047 0 0 0 88.712761 185.157367A356.478799 356.478799 0 0 0 0.063542 749.315994c8.138785 122.08178 96.851546 153.009165 225.444354 169.286736 0-16.277571-8.138785-32.148202-8.138785-48.425773a438.680531 438.680531 0 0 1 185.157367-362.582888z m660.462432-96.851546a229.106808 229.106808 0 0 0 88.712761-185.157367A220.154144 220.154144 0 0 0 926.664256 0.140801a203.469634 203.469634 0 0 0-162.775708 72.43519 304.390573 304.390573 0 0 1 177.018582 265.731342v8.138785A317.00569 317.00569 0 0 1 895.329932 515.732854a410.194782 410.194782 0 0 1 185.157367 362.582888 102.141756 102.141756 0 0 1-8.138785 48.425773c128.999748-8.138785 209.573723-40.693927 217.305569-169.286736a352.002467 352.002467 0 0 0-225.444355-346.305317z"></path></svg></span></span><a class="socialBtn_OKmL" href="https://www.linkedin.com/company/tdengine" target="_blank" rel="noopener noreferrer" aria-label="twitter link"><span class="icon_VBv9"><svg aria-hidden="true" role="img" height="1em" width="1em" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></span></a><a class="socialBtn_OKmL" href="https://stackoverflow.com/questions/tagged/td-engine" target="_blank" rel="noopener noreferrer" aria-label="twitter link"><span class="icon_VBv9"><svg height="200" width="200" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024"><path fill="#ffffff" d="M1024 640v384H0V640h128v256h768v-256zM192 704h640v128H192z m15.136-138.528l27.712-124.96 624.832 138.496-27.712 124.96z m72.512-256.928l54.08-116 580.032 270.464-54.08 116z m712.064 52.928l-77.92 101.536L406.048 73.408 462.4 0h58.24z"></path></svg></span></a><a class="socialBtn_OKmL" href="https://www.zhihu.com/people/tbase" target="_blank" rel="noopener noreferrer" aria-label="twitter link"><span class="icon_VBv9"><svg height="200" width="200" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024"><path fill="#ffffff" d="M564.7 230.1V803h60l25.2 71.4L756.3 803h131.5V230.1H564.7z m247.7 497h-59.9l-75.1 50.4-17.8-50.4h-18V308.3h170.7v418.8zM526.1 486.9H393.3c2.1-44.9 4.3-104.3 6.6-172.9h130.9l-0.1-8.1c0-0.6-0.2-14.7-2.3-29.1-2.1-15-6.6-34.9-21-34.9H287.8c4.4-20.6 15.7-69.7 29.4-93.8l6.4-11.2-12.9-0.7c-0.8 0-19.6-0.9-41.4 10.6-35.7 19-51.7 56.4-58.7 84.4-18.4 73.1-44.6 123.9-55.7 145.6-3.3 6.4-5.3 10.2-6.2 12.8-1.8 4.9-0.8 9.8 2.8 13 10.5 9.5 38.2-2.9 38.5-3 0.6-0.3 1.3-0.6 2.2-1 13.9-6.3 55.1-25 69.8-84.5h56.7c0.7 32.2 3.1 138.4 2.9 172.9h-141l-2.1 1.5c-23.1 16.9-30.5 63.2-30.8 65.2l-1.4 9.2h167c-12.3 78.3-26.5 113.4-34 127.4-3.7 7-7.3 14-10.7 20.8-21.3 42.2-43.4 85.8-126.3 153.6-3.6 2.8-7 8-4.8 13.7 2.4 6.3 9.3 9.1 24.6 9.1 5.4 0 11.8-0.3 19.4-1 49.9-4.4 100.8-18 135.1-87.6 17-35.1 31.7-71.7 43.9-108.9L497 850l5-12c0.8-1.9 19-46.3 5.1-95.9l-0.5-1.8-108.1-123-22 16.6c6.4-26.1 10.6-49.9 12.5-71.1h158.7v-8c0-40.1-18.5-63.9-19.2-64.9l-2.4-3z"></path></svg></span></a></div></div></div><div class="bottom_T_7l"><div class="bottomLeft_w8Yc"><p style="margin:0">© <span id="copy-year">2022</span> 涛思数据 | 京公网安备 11010502047618号 | 京ICP备17069529号-1</p></div><div class="bottomRight_W2kO"><a href="https://taosdata.com/careers">招贤纳士</a><a href="https://taosdata.com/terms-of-service">服务条款</a><a href="https://taosdata.com/privacy">隐私</a><a class="bottomLinkLast_haCH" href="https://taosdata.com/about">关于</a></div></div></div></div></div></div>
<script src="/assets/js/runtime~main.d597a18b.js"></script>
<script src="/assets/js/main.5a80987c.js"></script>
</body>
</html>