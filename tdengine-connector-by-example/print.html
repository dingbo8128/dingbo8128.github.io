<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TDengine Connector By Example</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="TDengine Connector By Example (TCBE) is a collection of runnable examples that illustrate features of various TDengine connectors.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="index.html">Preface</a></li><li class="chapter-item "><a href="prepare.html"><strong aria-hidden="true">1.</strong> Preparation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="prepare/intro_java.html"><strong aria-hidden="true">1.1.</strong> Prepare for Java Connector</a></li><li class="chapter-item "><a href="prepare/intro_python.html"><strong aria-hidden="true">1.2.</strong> Prepare for Python Connector</a></li><li class="chapter-item "><a href="prepare/intro_go.html"><strong aria-hidden="true">1.3.</strong> Prepare for Go Connector</a></li><li class="chapter-item "><a href="prepare/intro_Js.html"><strong aria-hidden="true">1.4.</strong> Prepare for Node.js Connector</a></li><li class="chapter-item "><a href="prepare/intro_cpp.html"><strong aria-hidden="true">1.5.</strong> Prepare for C++ Connector</a></li><li class="chapter-item "><a href="prepare/intro_rust.html"><strong aria-hidden="true">1.6.</strong> Prepare for Rust Connector</a></li><li class="chapter-item "><a href="prepare/intro_cs.html"><strong aria-hidden="true">1.7.</strong> Prepare for C# Connector</a></li><li class="chapter-item "><a href="prepare/intro_lua.html"><strong aria-hidden="true">1.8.</strong> Prepare for Lua Connector</a></li></ol></li><li class="chapter-item "><a href="connecting.html"><strong aria-hidden="true">2.</strong> Connecting to the Server</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="connecting/java.html"><strong aria-hidden="true">2.1.</strong> Get Connection with Java</a></li><li class="chapter-item "><a href="connecting/python.html"><strong aria-hidden="true">2.2.</strong> Get Connection with Python</a></li><li class="chapter-item "><a href="connecting/go.html"><strong aria-hidden="true">2.3.</strong> Get Connection with Go</a></li><li class="chapter-item "><a href="connecting/js.html"><strong aria-hidden="true">2.4.</strong> Get Connection with Node.js</a></li><li class="chapter-item "><a href="connecting/cpp.html"><strong aria-hidden="true">2.5.</strong> Get Connection with C++</a></li><li class="chapter-item "><a href="connecting/rust.html"><strong aria-hidden="true">2.6.</strong> Get Connection with Rust</a></li><li class="chapter-item "><a href="connecting/cs.html"><strong aria-hidden="true">2.7.</strong> Get Connection with C#</a></li><li class="chapter-item "><a href="connecting/lua.html"><strong aria-hidden="true">2.8.</strong> Get Connection with Lua</a></li></ol></li><li class="chapter-item "><a href="sync_query.html"><strong aria-hidden="true">3.</strong> Synchronous Query</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="sync_query/java.html"><strong aria-hidden="true">3.1.</strong> Synchronous Query with Java</a></li><li class="chapter-item "><a href="sync_query/python.html"><strong aria-hidden="true">3.2.</strong> Synchronous Query with Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="sync_query/python/pep.html"><strong aria-hidden="true">3.2.1.</strong> PEP-249 API</a></li><li class="chapter-item "><a href="sync_query/python/objective.html"><strong aria-hidden="true">3.2.2.</strong> Query API</a></li></ol></li><li class="chapter-item "><a href="sync_query/go.html"><strong aria-hidden="true">3.3.</strong> Synchronous Query with Go</a></li><li class="chapter-item "><a href="sync_query/js.html"><strong aria-hidden="true">3.4.</strong> Synchronous Query with Node.js</a></li><li class="chapter-item "><a href="sync_query/cpp.html"><strong aria-hidden="true">3.5.</strong> Synchronous Query with C++</a></li><li class="chapter-item "><a href="sync_query/rust.html"><strong aria-hidden="true">3.6.</strong> Synchronous Query with Rust</a></li><li class="chapter-item "><a href="sync_query/cs.html"><strong aria-hidden="true">3.7.</strong> Synchronous Query with C#</a></li><li class="chapter-item "><a href="sync_query/lua.html"><strong aria-hidden="true">3.8.</strong> Synchronous Query with Lua</a></li></ol></li><li class="chapter-item "><a href="async_query.html"><strong aria-hidden="true">4.</strong> Asynchronous Query</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="async_query/python.html"><strong aria-hidden="true">4.1.</strong> Asynchronous Query with Python</a></li><li class="chapter-item "><a href="async_query/go.html"><strong aria-hidden="true">4.2.</strong> Asynchronous Query with Go</a></li><li class="chapter-item "><a href="async_query/js.html"><strong aria-hidden="true">4.3.</strong> Asynchronous Query with Node.js</a></li><li class="chapter-item "><a href="async_query/cpp.html"><strong aria-hidden="true">4.4.</strong> Asynchronous Query with C++</a></li><li class="chapter-item "><a href="async_query/rust.html"><strong aria-hidden="true">4.5.</strong> Asynchronous Query with Rust</a></li><li class="chapter-item "><a href="async_query/cs.html"><strong aria-hidden="true">4.6.</strong> Asynchronous Query with C#</a></li><li class="chapter-item "><a href="async_query/lua.html"><strong aria-hidden="true">4.7.</strong> Asynchronous Query with Lua</a></li></ol></li><li class="chapter-item "><a href="stream.html"><strong aria-hidden="true">5.</strong> Continuous Query</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="stream/python.html"><strong aria-hidden="true">5.1.</strong> Continuous Query with Python</a></li><li class="chapter-item "><a href="stream/js.html"><strong aria-hidden="true">5.2.</strong> Continuous Query with Node.js</a></li><li class="chapter-item "><a href="stream/lua.html"><strong aria-hidden="true">5.3.</strong> Continuous Query with Lua</a></li></ol></li><li class="chapter-item "><a href="param_binding.html"><strong aria-hidden="true">6.</strong> Parameter Binding</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="param_binding/java.html"><strong aria-hidden="true">6.1.</strong> Parameter Binding with Java</a></li><li class="chapter-item "><a href="param_binding/python.html"><strong aria-hidden="true">6.2.</strong> Parameter Binding with Python</a></li><li class="chapter-item "><a href="param_binding/go.html"><strong aria-hidden="true">6.3.</strong> Parameter Binding with Go</a></li><li class="chapter-item "><a href="param_binding/cpp.html"><strong aria-hidden="true">6.4.</strong> Parameter Binding with C++</a></li><li class="chapter-item "><a href="param_binding/rust.html"><strong aria-hidden="true">6.5.</strong> Parameter Binding with Rust</a></li><li class="chapter-item "><a href="param_binding/cs.html"><strong aria-hidden="true">6.6.</strong> Parameter Binding with C#</a></li></ol></li><li class="chapter-item "><a href="schemaless.html"><strong aria-hidden="true">7.</strong> Schemaless</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="schemaless/java.html"><strong aria-hidden="true">7.1.</strong> Schemaless Writing with Java</a></li><li class="chapter-item "><a href="schemaless/python.html"><strong aria-hidden="true">7.2.</strong> Schemaless Writing with Python</a></li><li class="chapter-item "><a href="schemaless/go.html"><strong aria-hidden="true">7.3.</strong> Schemaless Writing with Go</a></li><li class="chapter-item "><a href="schemaless/js.html"><strong aria-hidden="true">7.4.</strong> Schemaless Writing with Node.js</a></li><li class="chapter-item "><a href="schemaless/cpp.html"><strong aria-hidden="true">7.5.</strong> Schemaless Writing with C++</a></li><li class="chapter-item "><a href="schemaless/rust.html"><strong aria-hidden="true">7.6.</strong> Schemaless Writing with Rust</a></li><li class="chapter-item "><a href="schemaless/cs.html"><strong aria-hidden="true">7.7.</strong> Schemaless Writing with C#</a></li><li class="chapter-item "><a href="schemaless/lua.html"><strong aria-hidden="true">7.8.</strong> Schemaless Writing with Lua</a></li></ol></li><li class="chapter-item "><a href="subscription.html"><strong aria-hidden="true">8.</strong> Subscription</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="subscription/java.html"><strong aria-hidden="true">8.1.</strong> Subscription with Java</a></li><li class="chapter-item "><a href="subscription/python.html"><strong aria-hidden="true">8.2.</strong> Subscription with Python</a></li><li class="chapter-item "><a href="subscription/go.html"><strong aria-hidden="true">8.3.</strong> Subscription with Go</a></li><li class="chapter-item "><a href="subscription/cpp.html"><strong aria-hidden="true">8.4.</strong> Subscription with C++</a></li><li class="chapter-item "><a href="subscription/js.html"><strong aria-hidden="true">8.5.</strong> Subscription with Node.js</a></li></ol></li><li class="chapter-item "><a href="nano.html"><strong aria-hidden="true">9.</strong> Use Nanoseconds</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nano/java.html"><strong aria-hidden="true">9.1.</strong> Nanoseconds in Java</a></li></ol></li><li class="chapter-item "><a href="json_type.html"><strong aria-hidden="true">10.</strong> JSON Type</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="json_type/java.html"><strong aria-hidden="true">10.1.</strong> JSON Type Support in Java</a></li><li class="chapter-item "><a href="json_type/python.html"><strong aria-hidden="true">10.2.</strong> JSON Type Support in Python</a></li><li class="chapter-item "><a href="json_type/go.html"><strong aria-hidden="true">10.3.</strong> JSON Type Support in Go</a></li><li class="chapter-item "><a href="json_type/js.html"><strong aria-hidden="true">10.4.</strong> JSON Type Support in Node.js</a></li><li class="chapter-item "><a href="json_type/cpp.html"><strong aria-hidden="true">10.5.</strong> JSON Type Support in C++</a></li><li class="chapter-item "><a href="json_type/rust.html"><strong aria-hidden="true">10.6.</strong> JSON Type Support in Rust</a></li><li class="chapter-item "><a href="json_type/cs.html"><strong aria-hidden="true">10.7.</strong> JSON Type Support in C#</a></li></ol></li><li class="chapter-item "><a href="restful.html"><strong aria-hidden="true">11.</strong> Restful API</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="restful/java.html"><strong aria-hidden="true">11.1.</strong> Use Restful API with Java</a></li><li class="chapter-item "><a href="restful/js.html"><strong aria-hidden="true">11.2.</strong> Use Restful API with Node.js</a></li><li class="chapter-item "><a href="restful/rust.html"><strong aria-hidden="true">11.3.</strong> Use Restful API with Rust</a></li></ol></li><li class="chapter-item "><a href="appendix.html"><strong aria-hidden="true">12.</strong> Appendix</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="appendix/c_api.html"><strong aria-hidden="true">12.1.</strong> C API Reference</a></li><li class="chapter-item "><a href="appendix/feature_matrix.html"><strong aria-hidden="true">12.2.</strong> Connector Feature Matrix</a></li><li class="chapter-item "><a href="appendix/troubles1.html"><strong aria-hidden="true">12.3.</strong> Troubleshooting One</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TDengine Connector By Example</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="tdengine-connectors-by-example"><a class="header" href="#tdengine-connectors-by-example">TDengine Connectors By Example</a></h1>
<p>TDengine is a highly efficient platform to store, query, and analyze time-series data. It is specially designed and optimized for IoT, Internet of Vehicles, Industrial IoT, IT Infrastructure and Application Monitoring, etc. TDengine provides many connectors for development, including C/C++, JAVA, Python, Go, Node.JS, C#, Lua, Rust.</p>
<p>This book is not <a href="https://www.taosdata.com/en/documentation/connector/">official document</a> about TDengine connectors. Instead it's a collection of runnable examples helping you start working with TDengine quickly. If you want to digger deep into TDengine connectors, official site and code repositories are right places for you.</p>
<p>Documents on official site and github repo are composed by connector developer themselves in order to give a complete and definitive guide, but this book is about doing not about concepts. On the other hand TDengine is evolving rapidly, here may be a good place to track the changes of APIs. To achieve this, running environment of every example in this book is emphasized. In case of API behavior change or new apis are introduced, a new example will be added.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="preparation"><a class="header" href="#preparation">Preparation</a></h1>
<p>First of all, you should have a running TDengine server for testing. There are so many ways to install TDengine.</p>
<h2 id="get-started"><a class="header" href="#get-started">Get started</a></h2>
<p>When I write this part, the latest version of TDengine is 2.2.2.0 and the following installing method still work well.</p>
<h3 id="install-using-apt-get-on-debian-or-ubuntu"><a class="header" href="#install-using-apt-get-on-debian-or-ubuntu">Install using apt-get on Debian or Ubuntu</a></h3>
<pre><code class="language-bash">wget -qO - http://repos.taosdata.com/tdengine.key | sudo apt-key add -
echo &quot;deb [arch=amd64] http://repos.taosdata.com/tdengine-stable stable main&quot; | sudo tee /etc/apt/sources.list.d/tdengine-stable.list
sudo apt-get update
apt-get policy tdengine
sudo apt-get install tdengine
sudo systemctl start taosd
systemctl status taosd
</code></pre>
<h3 id="install-from-package"><a class="header" href="#install-from-package">Install from package</a></h3>
<p>All packages can be found at <a href="https://www.taosdata.com/en/all-downloads/">https://www.taosdata.com/en/all-downloads/</a></p>
<h4 id="deb-package-on-debian-or-ubuntu"><a class="header" href="#deb-package-on-debian-or-ubuntu">deb package on Debian or Ubuntu</a></h4>
<p>Uninstall previous version:</p>
<pre><code>sudo dpkg -r tdengine
</code></pre>
<p>Install:</p>
<pre><code class="language-bash">sudo dpkg -i TDengine-server-2.2.1.3-Linux-x64.deb
sudo systemctl start taosd
</code></pre>
<h4 id="rpm-package-on-centos-or-redhat"><a class="header" href="#rpm-package-on-centos-or-redhat">rpm package on Centos or Redhat</a></h4>
<p>Uninstall previous version:</p>
<pre><code>sudo rpm -e tdengine
</code></pre>
<p>Install:</p>
<pre><code>sudo rpm -ivh TDengine-server-2.1.2.0-Linux-x64.rpm
sudo systemctl start taosd
</code></pre>
<h3 id="install-from-docker-image"><a class="header" href="#install-from-docker-image">Install from docker image</a></h3>
<pre><code class="language-ps">docker pull tdengine/tdengine:2.2.1.3
docker run -p 6030-6042:6030-6042/tcp -p 6030-6042:6030-6042/udp -d tdengine/tdengine:2.2.1.3
</code></pre>
<blockquote>
<p>The host name of container is random assigned. You should add container's hostname in your local host file, ie: <code>127.0.0.1 contain_hostname</code>, in order to avoid FQDN issues.</p>
</blockquote>
<!-- ### Build From Source

#### On Windows platform

```cmd
cmd
git pull git@github.com:taosdata/TDengine.git
cd TDengine
mkdir debug
cd debug
"C:\Program Files\Microsoft Visual Studio\2022\Professional\VC\Auxiliary\Build\vcvarsall.bat" x64
cmake .. -G "NMake Makefiles"
nmake
``` -->
<h3 id="firewall"><a class="header" href="#firewall">Firewall</a></h3>
<p>If you want to access remote TDengine server from local machine, please make sure the ports between 6030 and 6042 are open. On centos8, you can add the following file:</p>
<p><em><u>/lib/firewalld/services/taosd.xml</u></em></p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;

&lt;service&gt;
    &lt;short&gt;taosd&lt;/short&gt;
    &lt;description&gt;taosd.&lt;/description&gt;
    &lt;port protocol=&quot;tcp&quot; port=&quot;6030-6042&quot;/&gt;
    &lt;port protocol=&quot;udp&quot; port=&quot;6030-6042&quot;/&gt;
&lt;/service&gt;
</code></pre>
<p>Then</p>
<pre><code>sudo systemctl restart firewalld
</code></pre>
<h3 id="install-tdengine-client"><a class="header" href="#install-tdengine-client">Install TDengine Client</a></h3>
<p>TDengine Client is the <code>taosc</code> program and related dynamic link libraries. <code>taosc</code> is already included at server side.</p>
<p>On Windows system, just install <code>TDeingine-client-*-Windows-x64.exe</code>. On MacOS, building client from source is recommended, please refer to <a href="https://github.com/taosdata/TDengine">github</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-java-connector"><a class="header" href="#prepare-for-java-connector">Prepare for Java Connector</a></h1>
<h2 id="get-started-1"><a class="header" href="#get-started-1">Get Started</a></h2>
<ol>
<li>install JDK 1.8.x</li>
<li>install maven</li>
<li>install your prefer IDE</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-python-connector"><a class="header" href="#prepare-for-python-connector">Prepare for Python Connector</a></h1>
<h2 id="get-started-2"><a class="header" href="#get-started-2">Get Started</a></h2>
<ol>
<li>install python. python &gt;= 3.4 is recommended.</li>
<li>install pip</li>
<li>from TDengine2.1.1, you can install python connector from pypi.org
<pre><code>pip3 unisntall taospy
pip3 install taospy
</code></pre>
</li>
<li>before TDengine2.1.1, install locally, for example on Windows:
<pre><code>cd C:\TDengine\connector\python
python -m pip install .
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-go-connector"><a class="header" href="#prepare-for-go-connector">Prepare for Go Connector</a></h1>
<h2 id="1-install-gcc"><a class="header" href="#1-install-gcc">1. Install GCC</a></h2>
<p>Make sure <code>gcc</code> command can be found from command line, since <code>cgo</code> use it to compile C code. On Windows system,  you can follow bellow steps.</p>
<ol>
<li>install <a href="https://www.msys2.org/">msys2</a>.</li>
<li>install gcc by run:  <code>pacman -S mingw-w64-x86_64-gcc</code></li>
<li>add <code>C:\msys64\mingw64\bin</code> to PATH variable.</li>
</ol>
<h2 id="2-install-go"><a class="header" href="#2-install-go">2. Install Go</a></h2>
<p>Go 1.14+ is highly recommended.</p>
<h2 id="3-create-project"><a class="header" href="#3-create-project">3. Create Project</a></h2>
<pre><code class="language-ps">mkdir tdgotest
cd tdgotest
go mod init tdgotest
</code></pre>
<p>Then add demo program and run it. For example:</p>
<pre><code class="language-ps">mkdir connection
cd connection
vim main.go
go mod tidy
go run main.go
</code></pre>
<p><em><u>tdgotest/connection/main.go</u></em></p>
<pre><code class="language-go">package main

import (
	&quot;database/sql&quot;
	&quot;fmt&quot;

	_ &quot;github.com/taosdata/driver-go/v2/taosSql&quot;
)

func main() {
	var uri = &quot;root:taosdata/tcp(localhost:6030)/&quot;
	taos, err := sql.Open(&quot;taosSql&quot;, uri)
	if err != nil {
		fmt.Println(&quot;failed to connect TDengine, err:&quot;, err)
		return
	}
	defer taos.Close()
}
</code></pre>
<p><em><u>tdgotest/go.mod</u></em></p>
<pre><code>module tdgotest

go 1.17

require github.com/taosdata/driver-go/v2 v2.0.0
</code></pre>
<h2 id="4-differences-between-taossql-and-af"><a class="header" href="#4-differences-between-taossql-and-af">4. Differences between <code>taosSql</code> and <code>af</code></a></h2>
<p>There are two modules supplied by driver-go, <code>taosSql</code> and <code>af</code>. The module <code>taosSql</code> wrapper TDengine C API into standard <code>database/sql</code> API for traditional query and insertion operations. On the other hand, the module <code>af</code> contains advances features of TDengine, such as subscription and parameter binding.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-nodejs-connector"><a class="header" href="#prepare-for-nodejs-connector">Prepare for Node.js Connector</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-c-connector"><a class="header" href="#prepare-for-c-connector">Prepare for C++ Connector</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-rust-connector"><a class="header" href="#prepare-for-rust-connector">Prepare for Rust Connector</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-c-connector-1"><a class="header" href="#prepare-for-c-connector-1">Prepare for C# Connector</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prepare-for-lua-connector"><a class="header" href="#prepare-for-lua-connector">Prepare for Lua Connector</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="connecting-to-the-server"><a class="header" href="#connecting-to-the-server">Connecting to the Server</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-java"><a class="header" href="#get-connection-with-java">Get Connection with Java</a></h1>
<h2 id="1-pom-example"><a class="header" href="#1-pom-example">1. pom example</a></h2>
<pre><code class="language-xml">  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.taosdata.jdbc&lt;/groupId&gt;
      &lt;artifactId&gt;taos-jdbcdriver&lt;/artifactId&gt;
      &lt;version&gt;2.0.34&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.11&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
</code></pre>
<h2 id="2-get-started"><a class="header" href="#2-get-started">2. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.34</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
</ol>
<h3 id="21-example-get-connection-use-url"><a class="header" href="#21-example-get-connection-use-url">2.1 Example: Get Connection Use URL</a></h3>
<pre><code class="language-java">    @Test
    public void testGetConnection() throws SQLException {
        String jdbcUrl = String.format(&quot;jdbc:TAOS://%s:%s/%s?user=%s&amp;password=%s&quot;,
                &quot;localhost&quot;, &quot;6030&quot;, &quot;log&quot;, &quot;root&quot;, &quot;taosdata&quot;);
        Connection conn = DriverManager.getConnection(jdbcUrl);
        conn.close();
    }
</code></pre>
<h3 id="22-example-specify-user-and-password-outside-url"><a class="header" href="#22-example-specify-user-and-password-outside-url">2.2 Example: Specify User and Password outside URL</a></h3>
<pre><code class="language-java">    @Test
    public void testGetConnectionWithURLandParam() throws SQLException {
        Connection conn = DriverManager.getConnection(
                &quot;jdbc:TAOS://127.0.0.1:6030&quot;,
                &quot;root&quot;,
                &quot;taosdata&quot;);
        conn.close();
    }
</code></pre>
<h3 id="23-example-specify-connection-properties"><a class="header" href="#23-example-specify-connection-properties">2.3 Example: Specify Connection Properties</a></h3>
<p>Establishing a connection with URL and Properties.</p>
<pre><code class="language-java">    @Test
    public void getConnectionWithURLAndProperties() throws Exception {
        String jdbcUrl = &quot;jdbc:TAOS://localhost:6030?user=root&amp;password=taosdata&quot;;
        Properties connProps = new Properties();
        connProps.setProperty(TSDBDriver.PROPERTY_KEY_CHARSET, &quot;UTF-8&quot;);
        connProps.setProperty(TSDBDriver.PROPERTY_KEY_LOCALE, &quot;en_US.UTF-8&quot;);
        connProps.setProperty(TSDBDriver.PROPERTY_KEY_TIME_ZONE, &quot;UTC-8&quot;);
        Connection conn = DriverManager.getConnection(jdbcUrl, connProps);
        conn.close();
    }
</code></pre>
<h3 id="24-example-use-connection-configure-in-taoscfg"><a class="header" href="#24-example-use-connection-configure-in-taoscfg">2.4 Example: Use Connection Configure in taos.cfg</a></h3>
<p>Establishing a connection using parameters in the client configuration file. For example:</p>
<p><strong>taos.cfg</strong></p>
<pre><code class="language-cfg"># first fully qualified domain name (FQDN) for TDengine system
firstEp               cluster_node1:6030
# second fully qualified domain name (FQDN) for TDengine system, for cluster only
secondEp              cluster_node2:6030
</code></pre>
<p>You can omit host and port in URL, but user and password are essential.</p>
<pre><code class="language-java">    @Test
    public void getConnectionWithClientConfig() throws SQLException {
        Connection conn = DriverManager.getConnection(&quot;jdbc:TAOS://:/?user=root&amp;password=taosdata&quot;);
        conn.close();
    }
</code></pre>
<h3 id="25-example-get-error-message"><a class="header" href="#25-example-get-error-message">2.5 Example: Get Error Message</a></h3>
<p>Get JNI Error message.</p>
<pre><code class="language-java">    @Test
    public void testGetErrorInfo() {
        String jdbcUrl = String.format(&quot;jdbc:TAOS://%s:%s/%s?user=%s&amp;password=%s&quot;,
                &quot;localhost&quot;, &quot;6030&quot;, &quot;test768&quot;, &quot;root&quot;, &quot;taosdata&quot;);
        try (Connection conn = DriverManager.getConnection(jdbcUrl)) {
            // test
        } catch (SQLException e) {
            System.out.println(&quot;ErrorCode--&quot; + e.getErrorCode());
            System.out.println(&quot;ErrorMessage--&quot; + e.getMessage());
        }
    }
    // output
    // ErrorCode--9044
    // ErrorMessage--JNI ERROR (2354): Invalid database name
</code></pre>
<h3 id="26-example-use-connection-pool"><a class="header" href="#26-example-use-connection-pool">2.6 Example: Use Connection Pool</a></h3>
<p>Get connection from connection pool. </p>
<p>In order to run this example you should have add some dependencies in your <code>pom.xml</code> and properly configure log4j.</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.zaxxer&lt;/groupId&gt;
    &lt;artifactId&gt;HikariCP&lt;/artifactId&gt;
    &lt;version&gt;4.0.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
    &lt;version&gt;1.7.30&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
    &lt;version&gt;1.7.30&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<pre><code class="language-java">    @Test
    public void testConnectionPool() throws SQLException {
        HikariConfig config = new HikariConfig();
        // jdbc properties
        config.setJdbcUrl(&quot;jdbc:TAOS://localhost:6030/log&quot;);
        config.setUsername(&quot;root&quot;);
        config.setPassword(&quot;taosdata&quot;);
        // connection pool configurations
        config.setMinimumIdle(10);           //minimum number of idle connection
        config.setMaximumPoolSize(10);      //maximum number of connection in the pool
        config.setConnectionTimeout(30000); //maximum wait milliseconds for get connection from pool
        config.setMaxLifetime(0);       // maximum lifetime for each connection
        config.setIdleTimeout(0);       // max idle time for recycle idle connection
        config.setConnectionTestQuery(&quot;select server_status()&quot;); //validation query
        HikariDataSource ds = new HikariDataSource(config); //create datasource
        Connection connection = ds.getConnection(); // get connection
        Statement statement = connection.createStatement(); // get statement
        //query or insert
        statement.executeQuery(&quot;show databases&quot;);
        connection.close(); // put back to connection pool
    }
</code></pre>
<pre><code class="language-cmd">2021-12-09 10:08:32,819 (main) [       HikariConfig.java:1103:DEBUG] HikariPool-1 - configuration:
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] allowPoolSuspension................................false
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] autoCommit................................true
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] catalog................................none
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] connectionInitSql................................none
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] connectionTestQuery................................&quot;select server_status()&quot;
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] connectionTimeout................................30000
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] dataSource................................none
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] dataSourceClassName................................none
2021-12-09 10:08:32,835 (main) [       HikariConfig.java:1135:DEBUG] dataSourceJNDI................................none
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] dataSourceProperties................................{password=&lt;masked&gt;}
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] driverClassName................................none
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] exceptionOverrideClassName................................none
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] healthCheckProperties................................{}
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] healthCheckRegistry................................none
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] idleTimeout................................0
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] initializationFailTimeout................................1
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] isolateInternalQueries................................false
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] jdbcUrl................................jdbc:TAOS://localhost:6030/log
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] keepaliveTime................................0
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] leakDetectionThreshold................................0
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] maxLifetime................................0
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] maximumPoolSize................................10
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] metricRegistry................................none
2021-12-09 10:08:32,883 (main) [       HikariConfig.java:1135:DEBUG] metricsTrackerFactory................................none
2021-12-09 10:08:32,898 (main) [       HikariConfig.java:1135:DEBUG] minimumIdle................................10
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] password................................&lt;masked&gt;
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] poolName................................&quot;HikariPool-1&quot;
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] readOnly................................false
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] registerMbeans................................false
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] scheduledExecutor................................none
2021-12-09 10:08:32,899 (main) [       HikariConfig.java:1135:DEBUG] schema................................none
2021-12-09 10:08:32,900 (main) [       HikariConfig.java:1135:DEBUG] threadFactory................................internal
2021-12-09 10:08:32,900 (main) [       HikariConfig.java:1135:DEBUG] transactionIsolation................................default
2021-12-09 10:08:32,900 (main) [       HikariConfig.java:1135:DEBUG] username................................&quot;root&quot;
2021-12-09 10:08:32,900 (main) [       HikariConfig.java:1135:DEBUG] validationTimeout................................5000
2021-12-09 10:08:32,900 (main) [   HikariDataSource.java:80 :INFO ] HikariPool-1 - Starting...
2021-12-09 10:08:32,900 (main) [   DriverDataSource.java:107:DEBUG] Loaded driver with class name com.taosdata.jdbc.TSDBDriver for jdbcUrl=jdbc:TAOS://localhost:6030/log
2021-12-09 10:08:33,089 (main) [         HikariPool.java:565:DEBUG] HikariPool-1 - Added connection com.taosdata.jdbc.TSDBConnection@3567135c
2021-12-09 10:08:33,093 (main) [   HikariDataSource.java:82 :INFO ] HikariPool-1 - Start completed.

Process finished with exit code 0
</code></pre>
<h2 id="3--upgrade-to-jdbc-driver-2035"><a class="header" href="#3--upgrade-to-jdbc-driver-2035">3.  Upgrade to JDBC Driver 2.0.35</a></h2>
<p><strong>Test Environment:</strong></p>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.35</code></li>
<li>TDengin server:<code>*</code></li>
</ol>
<h3 id="31--set-tdengine-client-parameters"><a class="header" href="#31--set-tdengine-client-parameters">3.1  Set TDengine Client Parameters</a></h3>
<p>You can set more TDengine client parameters in both URL and properties now.</p>
<p>(testing)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-python"><a class="header" href="#get-connection-with-python">Get Connection with Python</a></h1>
<h2 id="1-pip-install-example"><a class="header" href="#1-pip-install-example">1. pip install example</a></h2>
<p>The easiest way to install Python Connector is <code>pip install</code>.</p>
<pre><code>pip unisntall taos taospy
pip install taospy==2.0.34
</code></pre>
<h2 id="2-get-started-1"><a class="header" href="#2-get-started-1">2. Get Started</a></h2>
<ol>
<li>python: <code>3.10</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
</ol>
<h3 id="21-example-get-server-version-and-client-version"><a class="header" href="#21-example-get-server-version-and-client-version">2.1. Example: Get Server Version and Client Version</a></h3>
<pre><code class="language-python">import taos


def test_connection():
    # all parameters are optional.
    # if database is specified,
    # then it must exist.
    # we use database log here, because it always exists.
    conn = taos.connect(host=&quot;127.0.0.1&quot;,
                        port=6030,
                        user=&quot;root&quot;,
                        password=&quot;taosdata&quot;,
                        database=&quot;log&quot;)
    print('client info:', conn.client_info)
    print('server info:', conn.server_info)
    conn.close()


</code></pre>
<pre><code class="language-cmd">client info: 2.2.1.3
server info: 2.2.1.3
</code></pre>
<h3 id="22-example-get-error-message"><a class="header" href="#22-example-get-error-message">2.2 Example: Get Error Message</a></h3>
<p>Get error message and error number.</p>
<pre><code class="language-python">def test_wrong_dbname():
    try:
        # if database is specified, then it must exist.
        conn = taos.connect(host=&quot;127.0.0.1&quot;,
                            port=6030,
                            user=&quot;root&quot;,
                            password=&quot;taosdata&quot;,
                            database=&quot;test753&quot;)
    except Exception as e:
        print(type(e), e)
        print(&quot;errno: &quot;, taos.taos_errno(None))
        print(&quot;errmsg:&quot;, taos.taos_errstr(None))


</code></pre>
<pre><code class="language-cmd">&lt;class 'taos.error.ConnectionError'&gt; [0xffff]: connect to TDengine failed
errno:  -2147482749
errmsg: Invalid database name
</code></pre>
<h3 id="23-example-use-connection-configure-in-taoscfg"><a class="header" href="#23-example-use-connection-configure-in-taoscfg">2.3 Example: Use Connection Configure in taos.cfg</a></h3>
<p>You can leave all parameters as default to simplify the code if your server and your client program run on the same host, or you have configured <code>firstEP</code> in <code>taos.cfg</code> </p>
<p><em><u>C:/TDengine/cfg/taos.cfg</u></em></p>
<pre><code class="language-cfg">firstEp       server_host_name:6030 # default localhost:6030
</code></pre>
<pre><code class="language-python">def test_use_default_params():
    conn = taos.connect()
    conn.close()


</code></pre>
<h3 id="24-example-print-table-names"><a class="header" href="#24-example-print-table-names">2.4 Example: Print Table Names</a></h3>
<p>You can change current database whenever you want by <code>select_db(db_name)</code>.</p>
<pre><code class="language-python">def test_select_db():
    conn = taos.connect()
    conn.select_db(&quot;log&quot;)
    result = conn.query(&quot;show tables&quot;)
    tables = result.fetch_all_into_dict()
    for t in tables:
        print(t[&quot;table_name&quot;])
</code></pre>
<pre><code class="language-cmd">acct_root
dn1
slowquery
log
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-go"><a class="header" href="#get-connection-with-go">Get Connection with Go</a></h1>
<h2 id="1-get-started"><a class="header" href="#1-get-started">1. Get Started</a></h2>
<ol>
<li>go: <code>1.17.2</code></li>
<li>driver-go: <code>v2.0.0</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h3 id="11-example-get-connection"><a class="header" href="#11-example-get-connection">1.1. Example: Get Connection</a></h3>
<pre><code class="language-go">package main

import (
	&quot;database/sql&quot;
	&quot;fmt&quot;

	_ &quot;github.com/taosdata/driver-go/v2/taosSql&quot;
)

func main() {
	// format: [user[:password]@][net[(addr)]]/dbname[?param1=value1&amp;paramN=valueN]
	var uri = &quot;root:taosdata/tcp(localhost:6030)/&quot;
	taos, err := sql.Open(&quot;taosSql&quot;, uri)
	if err != nil {
		fmt.Println(&quot;failed to connect TDengine, err:&quot;, err)
		return
	}
	defer taos.Close()
}
</code></pre>
<h3 id="12-example-connect-to-specific-database"><a class="header" href="#12-example-connect-to-specific-database">1.2 Example: Connect to Specific Database</a></h3>
<pre><code class="language-go">package main

import (
	&quot;database/sql&quot;
	&quot;fmt&quot;

	_ &quot;github.com/taosdata/driver-go/v2/taosSql&quot;
)

func main() {
	var uri = &quot;root:taosdata/tcp(localhost:6030)/log&quot;
	taos, err := sql.Open(&quot;taosSql&quot;, uri)
	if err != nil {
		fmt.Println(&quot;failed to connect TDengine, err:&quot;, err)
		return
	}
	defer taos.Close()
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-nodejs"><a class="header" href="#get-connection-with-nodejs">Get Connection with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-c"><a class="header" href="#get-connection-with-c">Get Connection with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-rust"><a class="header" href="#get-connection-with-rust">Get Connection with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-c-1"><a class="header" href="#get-connection-with-c-1">Get Connection with C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-connection-with-lua"><a class="header" href="#get-connection-with-lua">Get Connection with Lua</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query"><a class="header" href="#synchronous-query">Synchronous Query</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-java"><a class="header" href="#synchronous-query-with-java">Synchronous Query with Java</a></h1>
<h2 id="1-get-started-1"><a class="header" href="#1-get-started-1">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.34</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
</ol>
<h3 id="11-example"><a class="header" href="#11-example">1.1 Example:</a></h3>
<p>Create database and table.</p>
<pre><code class="language-java">    private Connection getConnection() throws SQLException {
        String jdbcUrl = String.format(&quot;jdbc:TAOS://%s:%s/%s?user=%s&amp;password=%s&quot;,
                &quot;localhost&quot;, &quot;6030&quot;, &quot;&quot;, &quot;root&quot;, &quot;taosdata&quot;);
        Connection conn = DriverManager.getConnection(jdbcUrl);
        return conn;
    }

    @Test
    public void testCreateDatabaseAndTable() {
        try (Connection conn = getConnection()) {
            Statement stmt = conn.createStatement();
            // create database
            stmt.executeUpdate(&quot;create database if not exists test&quot;);
            // use database
            stmt.executeUpdate(&quot;use test&quot;);
            // create table
            stmt.executeUpdate(&quot;create table if not exists tb (ts timestamp, temperature int, humidity float)&quot;);
            // drop database
            stmt.executeUpdate(&quot;drop database test&quot;);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
</code></pre>
<h3 id="example-02"><a class="header" href="#example-02">Example 0.2</a></h3>
<p>Insert and query.</p>
<pre><code class="language-java">    @Test
    public void testInsertAndQuery() {
        try(Connection conn = getConnection()) {
            Statement stmt = conn.createStatement();
            stmt.executeUpdate(&quot;create database if not exists test&quot;);
            stmt.executeUpdate(&quot;use test&quot;);
            stmt.executeUpdate(&quot;create table if not exists tb (ts timestamp, temperature int, humidity float)&quot;);
            // insert data
            int affectedRows = stmt.executeUpdate(&quot;insert into tb values(now, 23, 10.3) (now + 1s, 20, 9.3)&quot;);
            System.out.println(&quot;insert &quot; + affectedRows + &quot; rows.&quot;);
            // query data
            ResultSet resultSet = stmt.executeQuery(&quot;select * from tb&quot;);
            Timestamp ts = null;
            int temperature = 0;
            float humidity = 0;
            while (resultSet.next()) {
                ts = resultSet.getTimestamp(1);
                temperature = resultSet.getInt(2);
                humidity = resultSet.getFloat(&quot;humidity&quot;);
                System.out.printf(&quot;%s, %d, %s\n&quot;, ts, temperature, humidity);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    //output
    //insert 2 rows.
    //2021-12-07 09:23:04.588, 23, 10.3
    //2021-12-07 09:23:05.588, 20, 9.3
</code></pre>
<p><strong>Note:</strong> The query is consistent with the operation of the relational database, and the index in ResultSet starts from 1.</p>
<h3 id="example-03"><a class="header" href="#example-03">Example 0.3</a></h3>
<p>Handle exceptions.</p>
<pre><code class="language-java">    @Test
    public void testHandleException() throws SQLException {
        try(Connection connection = getConnection()) {
            try (Statement statement = connection.createStatement()) {
                // executeQuery
                ResultSet resultSet = statement.executeQuery(&quot;select * from test.tb_not_exist&quot;);
            } catch (SQLException e) {
                System.out.println(&quot;ERROR Message: &quot; + e.getMessage());
                System.out.println(&quot;ERROR Code: &quot; + e.getErrorCode());
                e.printStackTrace();
            }
        }
    }
    //output
    //ERROR Message: TDengine ERROR (80000362): Table does not exist
    //ERROR Code: -2147482782
    //java.sql.SQLException: TDengine ERROR (80000362): Table does not exist
    //at com.taosdata.jdbc.TSDBError.createSQLException(TSDBError.java:75)
    //at com.taosdata.jdbc.TSDBJNIConnector.executeQuery(TSDBJNIConnector.java:123)
    //at com.taosdata.jdbc.TSDBStatement.executeQuery(TSDBStatement.java:44)
    //at TestSyncQuery.testHandleException(TestSyncQuery.java:75)
</code></pre>
<h3 id="example-04"><a class="header" href="#example-04">Example 0.4</a></h3>
<p>Get meta data from ResultSet and print result with column names.</p>
<pre><code class="language-java">    @Test
    public void printResult() {
        try(Connection conn = getConnection()) {
            Statement stmt = conn.createStatement();
            ResultSet resultSet = stmt.executeQuery(&quot;select * from test.tb&quot;);
            ResultSetMetaData metaData = resultSet.getMetaData();
            while (resultSet.next()) {
                for (int i = 1; i &lt;= metaData.getColumnCount(); i++) {
                    String columnLabel = metaData.getColumnLabel(i);
                    String value = resultSet.getString(i);
                    System.out.printf(&quot;%s: %s\t&quot;, columnLabel, value);
                }
                System.out.println();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    //output
    //ts: 2021-12-07 09:23:04.588	temperature: 23	humidity: 10.3
    //ts: 2021-12-07 09:23:05.588	temperature: 20	humidity: 9.3
</code></pre>
<h3 id="example-05"><a class="header" href="#example-05">Example 0.5</a></h3>
<p>Batch insertion syntax.</p>
<pre><code class="language-sql">INSERT INTO t1 USING stb1 TAGS ('Beijing', 2) 
                VALUES ('2021-07-13 14:06:34.630', 10.2, 219, 0.32)
                       ('2021-07-13 14:06:35.779', 10.15, 217, 0.33)
            t2 USING stb2 (groupId) TAGS (2) 
                VALUES ('2021-07-13 14:06:34.255', 10.15, 217, 0.33)
            t3 USING stb3 (groupId) TAGS (2) (ts, current, phase)
                VALUES ('2021-07-13 14:06:34.255', 10.27, 0.31);
</code></pre>
<p>Batch insertion example that generate sql using StringBuilder.</p>
<pre><code class="language-java">    private static final String dbname = &quot;test&quot;;
    private static final String stbname = &quot;stb&quot;;
    private static final int tables= 100;
    private static final int rows = 500;
    private static final long ts = 1604877767000l;

    private String generateSql() {
        StringBuilder sb = new StringBuilder();
        Random rand = new Random();
        sb.append(&quot;insert into &quot;);
        for (int i = 0; i &lt; tables; i++) {
            sb.append(dbname + &quot;.tb&quot; + i + &quot; using &quot; + dbname + &quot;.&quot; + stbname + &quot; tags(&quot; + i +  &quot;) values&quot;);
            for (int j = 0; j &lt; rows; j++) {
                sb.append(&quot;(&quot;);
                sb.append(ts + j);
                sb.append(&quot;,&quot;);
                sb.append(rand.nextInt(1000));
                sb.append(&quot;) &quot;);
            }
        }
        return sb.toString();
    }

    @Test
    public void testBatchInsert() throws SQLException {
        try(Connection conn = getConnection()) {
            String sql = generateSql();
            try (Statement stmt = conn.createStatement()) {
                stmt.execute(&quot;create table if not exists &quot; + dbname + &quot;.&quot; + stbname + &quot;(ts timestamp, col int) tags(id int)&quot;);
                long start = System.currentTimeMillis();
                stmt.execute(sql);
                long end = System.currentTimeMillis();
                System.out.println(&quot;insert &quot; + tables * rows + &quot; records, cost &quot; + (end - start) + &quot;ms&quot;);
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
        }
    }
    //output
    //insert 50000 records, cost 686ms
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-python"><a class="header" href="#synchronous-query-with-python">Synchronous Query with Python</a></h1>
<p>Python connector provide two style query APIs.</p>
<ol>
<li><a href="https://www.python.org/dev/peps/pep-0249/">PEP-249</a> style. The common use pattern is:
<pre><code class="language-python">import taos
conn = taos.connect()
cursor = conn.cursor()
cursor.execute(sql)
</code></pre>
</li>
<li>Objective style. The common use pattern is:
<pre><code class="language-python">import taos
conn = taos.connect()
result = conn.query(sql)
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pep-249-api"><a class="header" href="#pep-249-api">PEP-249 API</a></h1>
<h2 id="1-get-started-2"><a class="header" href="#1-get-started-2">1. Get Started</a></h2>
<ol>
<li>python: <code>3.10</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
</ol>
<h3 id="11-example-show-database"><a class="header" href="#11-example-show-database">1.1. Example: &quot;show database&quot;</a></h3>
<pre><code class="language-python">def test_pep_249_api():
    conn: taos.TaosConnection = taos.connect(host=&quot;localhost&quot;, port=6030)
    cursor: taos.TaosCursor = conn.cursor()
    cursor.execute(&quot;show databases&quot;)
    rows: List[tuple] = cursor.fetchall()
    for row in rows:
        print(row)
    cursor.close()
    conn.close()


</code></pre>
<pre><code class="language-cmd">('test', datetime.datetime(2021, 11, 26, 13, 46, 31, 366000), 1132, 2, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')
('log', datetime.datetime(2021, 11, 26, 11, 53, 29, 93000), 4, 1, 1, 1, 10, '30', 1, 3, 100, 4096, 1, 3000, 2, 0, 'us', 0, 'ready')
('db126', datetime.datetime(2021, 12, 7, 9, 23, 4, 565000), 1, 1, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')
('test_rest', datetime.datetime(2021, 12, 10, 17, 11, 13, 568000), 1, 1, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')
('test_rust_double_quote_tag', datetime.datetime(2021, 12, 10, 11, 25, 3, 129000), 1, 1, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')
('test_no_db', datetime.datetime(2021, 12, 10, 15, 23, 35, 858000), 0, 0, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')
</code></pre>
<h3 id="12-example-insert-and-select"><a class="header" href="#12-example-insert-and-select">1.2. Example: insert and select</a></h3>
<pre><code class="language-python">def test_insert_and_select():
    conn: taos.TaosConnection = taos.connect(host=&quot;localhost&quot;, port=6030)
    cursor: taos.TaosCursor = conn.cursor()
    result = cursor.execute(&quot;create database if not exists pytest&quot;)
    print(&quot;result:&quot;, result, &quot;affected_rows:&quot;, cursor.affected_rows)  # result = affected_row

    result = cursor.execute(&quot;create table pytest.t1(ts timestamp, c1 int)&quot;)
    print(&quot;\nresult:&quot;, result, &quot;affected_rows:&quot;, cursor.affected_rows)  # result = affected_row

    result = cursor.execute(&quot;insert into pytest.t1 values(now, 1) (now + 1s, 2) (now + 2s, 3)&quot;)
    print(&quot;\nresult:&quot;, result, &quot;affected_rows:&quot;, cursor.affected_rows)

    result = cursor.execute(&quot;select * from pytest.t1&quot;)
    print(&quot;\nresult:&quot;, result, &quot;affected_rows:&quot;,
          cursor.affected_rows)  # for select, result is strange, affected_row is zero.

    rows: List[tuple] = cursor.fetchall()
    print(&quot;\n================rows========================&quot;)
    for row in rows:
        print(row)

    print(&quot;\nrowcount:&quot;, cursor.rowcount)
    print(&quot;description:&quot;, cursor.description)
    cursor.execute(&quot;drop database pytest&quot;)
    cursor.close()
    conn.close()


</code></pre>
<pre><code class="language-cmd">result: 0 affected_rows: 0

result: 0 affected_rows: 0

result: 3 affected_rows: 3

result: c_void_p(1865719331552) affected_rows: 0

================rows========================
(datetime.datetime(2021, 12, 16, 17, 19, 28, 999000), 1)
(datetime.datetime(2021, 12, 16, 17, 19, 29, 999000), 2)
(datetime.datetime(2021, 12, 16, 17, 19, 30, 999000), 3)

rowcount: 3
description: [('ts', 9, None, None, None, None, False), ('c1', 4, None, None, None, None, False)]
</code></pre>
<p><strong>Note:</strong></p>
<ol>
<li><code>cursor.rowcount</code> must be called after calling <code>fetchall()</code>.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-api"><a class="header" href="#query-api">Query API</a></h1>
<h2 id="1-get-started-3"><a class="header" href="#1-get-started-3">1. Get Started</a></h2>
<ol>
<li>python: <code>3.10</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
</ol>
<p>The <code>query</code> method returns <code>TaosResult</code> class. It provides high level APIs for convenient use:</p>
<p><strong>Properties:</strong></p>
<ul>
<li>fields: the TaosFields object contains the column metadata.</li>
<li>field_count: column number of result.</li>
<li>affected_rows: the rows completed for insert.</li>
<li>row_count: the rows number for select.</li>
<li>precision: the result precision.</li>
</ul>
<p><strong>Methods:</strong></p>
<ul>
<li>fetch_all(): get all data as tuple array.</li>
<li>fetch_all_into_dict(): get all data as dict array, added since v2.1.1</li>
<li>blocks_iter(): provides iterator by C taos_fetch_blocks API</li>
<li>rows_iter(): provides iterator by C taos_fetch_row API</li>
<li>fetch_rows_a: fetch rows by async API.</li>
</ul>
<h3 id="11-example-iterate-on-result"><a class="header" href="#11-example-iterate-on-result">1.1. Example: Iterate on Result</a></h3>
<pre><code class="language-python">def test_objective_api():
    conn = taos.connect(host=&quot;localhost&quot;, port=6030)
    conn.execute(&quot;create database if not exists pytest&quot;)
    result: taos.TaosResult = conn.query(&quot;show databases&quot;)

    print(&quot;field_count:&quot;, result.field_count, &quot;\n&quot;)

    for field in result.fields:
        print(field)
    # inter on result
    for row in result:
        print(&quot;row:&quot;, row)

    print(&quot;\nfield_lengths:&quot;, result.field_lengths())

    result.close()
    conn.execute(&quot;drop database pytest&quot;)
    conn.close()


</code></pre>
<pre><code class="language-cmd">field_count: 19

{name: name, type: 8, bytes: 32}
{name: created_time, type: 9, bytes: 8}
{name: ntables, type: 4, bytes: 4}
......

row: ('log', datetime.datetime(2021, 11, 26, 11, 53, 29, 93000), 4, 1, 1, 1, 10, '30', 1, 3, 100, 4096, 1, 3000, 2, 0, 'us', 0, 'ready')
row: ('pytest', datetime.datetime(2021, 12, 16, 21, 18, 41, 518000), 0, 0, 1, 1, 10, '3650', 16, 6, 100, 4096, 1, 3000, 2, 0, 'ms', 0, 'ready')

field_lengths: [34, 8, 4, 4, 2, 2, 2, 26, 4, 4, 4, 4, 1, 4, 1, 1, 5, 1, 12]
</code></pre>
<p><strong>Note:</strong></p>
<ol>
<li><code>conn.execute</code> is a shorthand for <code>conn.query(sql).affected_rows</code>.</li>
</ol>
<h3 id="12-example-fetch-result-into-list"><a class="header" href="#12-example-fetch-result-into-list">1.2. Example: Fetch Result into List</a></h3>
<p>Insert three rows and fetch them into dict.</p>
<pre><code class="language-python">def test_objective_api2():
    conn = taos.connect(host=&quot;localhost&quot;, port=6030)
    conn.query(&quot;create database if not exists pytest&quot;)
    conn.query(&quot;create table pytest.t1(ts timestamp, c1 int)&quot;)
    result: taos.TaosResult = conn.query(&quot;insert into pytest.t1 values(now, 1) (now + 1s, 2) (now + 2s, 3)&quot;)
    print(&quot;affected_rows:&quot;, result.affected_rows)
    result: taos.TaosResult = conn.query(&quot;select * from pytest.t1&quot;)
    # fetch result into list of dict
    data = result.fetch_all_into_dict()
    print(data)
    conn.close()


</code></pre>
<pre><code class="language-cmd">affected_rows: 3
[
 {'ts': datetime.datetime(2021, 12, 16, 21, 10, 20, 694000), 'c1': 1},
 {'ts': datetime.datetime(2021, 12, 16, 21, 10, 21, 694000), 'c1': 2},
 {'ts': datetime.datetime(2021, 12, 16, 21, 10, 22, 694000), 'c1': 3}
]
</code></pre>
<h3 id="13-example-blocks-iter"><a class="header" href="#13-example-blocks-iter">1.3. Example: Blocks Iter</a></h3>
<pre><code class="language-python">def test_blocks_iter():
    conn = taos.connect(host=&quot;localhost&quot;, port=6030)
    result: taos.TaosResult = conn.query(&quot;select * from pytest.t1&quot;)
    i = 1
    for blk in result.blocks_iter():
        print(&quot;block&quot;, i)
        print(blk)
        i += 1
    conn.query(&quot;drop database pytest&quot;)
    conn.close()


</code></pre>
<pre><code class="language-cmd">block 1
([(datetime.datetime(2021, 12, 16, 22, 21, 46, 122000), 1), 
  (datetime.datetime(2021, 12, 16, 22, 21, 47, 122000), 2), 
  (datetime.datetime(2021, 12, 16, 22, 21, 48, 122000), 3)], 
 3
)
</code></pre>
<p>It's useful when the result set is very big.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-go"><a class="header" href="#synchronous-query-with-go">Synchronous Query with Go</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-nodejs"><a class="header" href="#synchronous-query-with-nodejs">Synchronous Query with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-c"><a class="header" href="#synchronous-query-with-c">Synchronous Query with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-rust"><a class="header" href="#synchronous-query-with-rust">Synchronous Query with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-c-1"><a class="header" href="#synchronous-query-with-c-1">Synchronous Query with C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synchronous-query-with-lua"><a class="header" href="#synchronous-query-with-lua">Synchronous Query with Lua</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query"><a class="header" href="#asynchronous-query">Asynchronous Query</a></h1>
<p>In addition to synchronous API, TDengine also provides higher performance asynchronous call API to handle data insertion and query operations. Under the same software and hardware environment, asynchronous API processes data insertion 2 ~ 4 times faster than synchronous API.</p>
<p>TDengine has a build-in database named log. We'll use it for demo in this chapter.</p>
<pre><code class="language-cmd">taos&gt; select * from oog.log limit 3\G;
*************************** 1.row ***************************
     ts: 2021-11-26 11:53:52.329091
  level: 0
content: user:root login from 127.0.0.1, result:success
 ipaddr: localhost:6030
*************************** 2.row ***************************
     ts: 2021-11-26 11:54:39.072420
  level: 0
content: user:root login from 127.0.0.1, result:success
 ipaddr: localhost:6030
*************************** 3.row ***************************
     ts: 2021-11-26 13:46:31.364405
  level: 0
content: user:root login from 127.0.0.1, result:success
 ipaddr: localhost:6030
Query OK, 3 row(s) in set (0.023000s)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-python"><a class="header" href="#asynchronous-query-with-python">Asynchronous Query with Python</a></h1>
<h2 id="1-get-started-4"><a class="header" href="#1-get-started-4">1. Get Started</a></h2>
<ol>
<li>python: <code>3.9</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
<li>Ubuntu 18.04.5 LTS</li>
</ol>
<h3 id="11-example-1"><a class="header" href="#11-example-1">1.1 Example</a></h3>
<pre><code class="language-python">import time
from ctypes import *

from taos import *


def fetch_callback(p_param, p_result, num_of_rows):
    print(&quot;fetched &quot;, num_of_rows, &quot;rows&quot;)
    p = cast(p_param, POINTER(Counter))
    result = TaosResult(p_result)

    if num_of_rows == 0:
        print(&quot;fetching completed&quot;)
        p.contents.done = True
        result.close()
        return
    if num_of_rows &lt; 0:
        p.contents.done = True
        result.check_error(num_of_rows)
        result.close()
        return None

    for row in result.rows_iter(num_of_rows):
        print(row)
    p.contents.count += result.row_count
    result.fetch_rows_a(fetch_callback, p_param)


def query_callback(p_param, p_result, code):
    if p_result is None:
        return
    result = TaosResult(p_result)
    if code == 0:
        result.fetch_rows_a(fetch_callback, p_param)
    result.check_error(code)


class Counter(Structure):
    _fields_ = [(&quot;count&quot;, c_int), (&quot;done&quot;, c_bool)]

    def __str__(self):
        return &quot;{ count: %d, done: %s }&quot; % (self.count, self.done)


def test_query(conn):
    counter = Counter(count=0)
    conn.query_a(&quot;select * from log.log&quot;, query_callback, byref(counter))

    while not counter.done:
        print(&quot;wait query callback&quot;)
        time.sleep(1)
    print(counter)
    conn.close()


if __name__ == &quot;__main__&quot;:
    test_query(connect())
</code></pre>
<pre><code class="language-cmd">wait query callback
fetched  73 rows
1637490215269515 0 user:root login from 172.17.216.6, result:success wz001:6030
1637494758929281 0 user:root login from 172.17.216.6, result:success wz001:6030
1637494868062144 0 user:root login from 172.17.216.6, result:success wz001:6030
1637495088432295 0 user:root login from 172.17.216.6, result:success wz001:6030
1637497175331085 0 user:root login from 172.17.216.6, result:success wz001:6030
1637498891163761 0 user:root login from 124.64.17.219, result:success wz001:6030
1637499525976902 0 user:root login from 124.64.17.219, result:success wz001:6030
1637499583040030 0 user:root login from 124.64.17.219, result:success wz001:6030
1637499839798334 0 user:root login from 124.64.17.219, result:success wz001:6030
1637499865215357 0 user:root login from 124.64.17.219, result:success wz001:6030
1637499914305162 0 user:root login from 124.64.17.219, result:success wz001:6030
1637500295830038 0 user:root login from 124.64.17.219, result:success wz001:6030
1637501280572051 0 user:root login from 124.64.17.219, result:success wz001:6030
1637501597286166 0 user:root login from 124.64.17.219, result:success wz001:6030
1637502418694962 0 user:root login from 127.0.0.1, result:success wz001:6030
</code></pre>
<p><strong>Note:</strong> This example not work on Windows System.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-go"><a class="header" href="#asynchronous-query-with-go">Asynchronous Query with Go</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-nodejs"><a class="header" href="#asynchronous-query-with-nodejs">Asynchronous Query with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-c"><a class="header" href="#asynchronous-query-with-c">Asynchronous Query with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-rust"><a class="header" href="#asynchronous-query-with-rust">Asynchronous Query with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-c-1"><a class="header" href="#asynchronous-query-with-c-1">Asynchronous Query with C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-query-with-lua"><a class="header" href="#asynchronous-query-with-lua">Asynchronous Query with Lua</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="continuous-query"><a class="header" href="#continuous-query">Continuous Query</a></h1>
<p>TDengine provides time-driven real-time stream computing APIs. You can perform various real-time aggregation calculation operations on tables (data streams) of one or more databases at regular intervals.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="continuous-query-with-python"><a class="header" href="#continuous-query-with-python">Continuous Query with Python</a></h1>
<h2 id="1-get-started-5"><a class="header" href="#1-get-started-5">1. Get Started</a></h2>
<ol>
<li>python: <code>3.9</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
<li>Ubuntu 18.04.5 LTS</li>
</ol>
<h3 id="11-example-2"><a class="header" href="#11-example-2">1.1 Example</a></h3>
<pre><code class="language-python">import time
from ctypes import *

from taos import *


def stream_callback(p_param, p_result, p_row):
    if p_result == None or p_row == None:
        return
    result = TaosResult(p_result)
    row = TaosRow(result, p_row)
    try:
        ts, count = row()
        p = cast(p_param, POINTER(Counter))
        p.contents.count += count
        print(&quot;[%s] inserted %d in 5s, total count: %d&quot; % (ts.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;), count, p.contents.count))
    except Exception as err:
        print(err)
        raise err


class Counter(Structure):
    _fields_ = [
        (&quot;count&quot;, c_int),
    ]

    def __str__(self):
        return &quot;%d&quot; % self.count


def test_stream(conn):
    dbname = &quot;pytest_taos_stream&quot;
    try:
        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.execute(&quot;create database if not exists %s&quot; % dbname)
        conn.select_db(dbname)
        conn.execute(&quot;create table if not exists log(ts timestamp, n int)&quot;)

        result = conn.query(&quot;select count(*) from log interval(5s)&quot;)
        assert result.field_count == 2
        counter = Counter()
        counter.count = 0
        stream = conn.stream(&quot;select count(*) from log interval(5s)&quot;, stream_callback, param=byref(counter))

        for _ in range(0, 20):
            conn.execute(&quot;insert into log values(now,0)(now+1s, 1)(now + 2s, 2)&quot;)
            time.sleep(2)

        stream.close()
        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.close()
    except Exception as err:
        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.close()
        raise err


if __name__ == &quot;__main__&quot;:
    test_stream(connect())
</code></pre>
<pre><code class="language-cmd">[2021-12-21 14:35:25] inserted 6 in 5s, total count: 6
[2021-12-21 14:35:30] inserted 7 in 5s, total count: 13
[2021-12-21 14:35:35] inserted 8 in 5s, total count: 21
</code></pre>
<p><strong>Note:</strong> This example not work on Windows System.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="continuous-query-with-nodejs"><a class="header" href="#continuous-query-with-nodejs">Continuous Query with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="continuous-query-with-lua"><a class="header" href="#continuous-query-with-lua">Continuous Query with Lua</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding"><a class="header" href="#parameter-binding">Parameter Binding</a></h1>
<p>Since version 2.1.2.0, in addition to  <code>taos_query</code> C API, TDengine also provides a Prepare API that supports parameter binding. Like MySQL, these APIs currently only support using question mark <code>?</code> to represent the parameters to be bound, for example:</p>
<pre><code class="language-sql">insert into ? using weather tags(?, ?) values(?, ?, ?);
</code></pre>
<p>Writing data this way can avoid SQL parsing and significantly improve the write performance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-java"><a class="header" href="#parameter-binding-with-java">Parameter Binding with Java</a></h1>
<p>Since version 2.1.2.0, TDengine's JDBC-JNI implementation has significantly improved parameter binding support for data write (INSERT) scenarios avoiding SQL parsing and significantly improving the write performance.</p>
<h2 id="1-get-started-6"><a class="header" href="#1-get-started-6">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.34</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
</ol>
<h3 id="11-example-3"><a class="header" href="#11-example-3">1.1 Example</a></h3>
<pre><code class="language-java">package com.taos.tdjava;

import com.taosdata.jdbc.TSDBPreparedStatement;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Random;

public class TestParamBind {
    private static Random r = new Random();

    private static Connection getConnection() throws SQLException {
        Connection conn = DriverManager.getConnection(&quot;jdbc:TAOS://127.0.0.1:6030&quot;, &quot;root&quot;, &quot;taosdata&quot;);
        return conn;
    }

    private static void createTable(Connection conn) throws SQLException {
        try(Statement stmt = conn.createStatement()) {
            stmt.executeUpdate(&quot;create database if not exists java_test&quot;);
            stmt.executeUpdate(&quot;use java_test&quot;);
            stmt.executeUpdate(&quot;drop table if exists weather&quot;);
            stmt.executeUpdate(&quot;create stable if not exists &quot; +
                    &quot;weather(ts timestamp, c1 int, c2 binary(10)) &quot; +
                    &quot;tags(no int, location binary(10))&quot;);
        }
    }

    public static void test() throws SQLException {
        try (Connection conn = getConnection()) {
            createTable(conn);
            // In the INSERT statement,
            // the VALUES clause allows you to specify a specific column;
            // If automatic table creation is adopted,
            // the TAGS clause needs to set the parameter values of all TAGS columns
            String psql = &quot;insert into ? using weather tags (?, ?) (ts, c1, c2) values(?, ?, ?)&quot;;
            try (TSDBPreparedStatement pst = (TSDBPreparedStatement) conn.prepareStatement(psql)) {
                pst.setTableName(&quot;w1&quot;);
                // set tags
                pst.setTagInt(0, r.nextInt(10));
                pst.setTagString(1, &quot;Beijing&quot;);
                int numOfRows = 10;
                // set values
                ArrayList&lt;Long&gt; ts = new ArrayList&lt;&gt;();
                for (int i = 0; i &lt; numOfRows; i++) {
                    ts.add(System.currentTimeMillis() + i);
                }
                pst.setTimestamp(0, ts);
                ArrayList&lt;Integer&gt; s1 = new ArrayList&lt;&gt;();
                for (int i = 0; i &lt; numOfRows; i++) {
                    s1.add(r.nextInt(100));
                }
                pst.setInt(1, s1);
                ArrayList&lt;String&gt; s2 = new ArrayList&lt;&gt;();
                for (int i = 0; i &lt; numOfRows; i++) {
                    s2.add(&quot;test&quot; + r.nextInt(100));
                }
                pst.setString(2, s2, 10);
                // The cache is not cleared after AddBatch. Do not bind new data again before ExecuteBatch
                pst.columnDataAddBatch();
                pst.columnDataExecuteBatch();
                // Clear the cache, after which you can bind new data(including table names, tags, values):
                pst.columnDataClearBatch();
                pst.columnDataCloseBatch();
            }
        }
    }

    public static void main(String[] args) {
        try {
            test();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}

</code></pre>
<pre><code class="language-shell">taos&gt; select  tbname, * from weather;
             tbname             |           ts            |     c1      |     c2     |     no      |  location  |
=================================================================================================================
 w1                             | 2021-12-20 12:11:28.277 |          16 | test64     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.278 |          87 | test21     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.279 |           5 | test41     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.280 |          34 | test44     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.281 |          96 | test19     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.282 |          29 | test0      |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.283 |          66 | test59     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.284 |          41 | test64     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.285 |          78 | test88     |           7 | Beijing    |
 w1                             | 2021-12-20 12:11:28.286 |          28 | test45     |           7 | Beijing    |
Query OK, 10 row(s) in set (0.119000s)
</code></pre>
<p><strong>Note:</strong></p>
<ol>
<li>For one batch of data, <code>setTableName</code> and <code>setTag*</code> only need to call once, which means, the batch of data must belong to the same table.</li>
<li>Use <code>setString</code> for column with type <code>binary</code>; Use <code>setNString</code> for column with type <code>nchar</code>. </li>
<li>Both <code>setString</code> and <code>setNString</code> require the user to declare the column width of the corresponding column in the table definition in the size parameter.</li>
</ol>
<h3 id="12-related-api"><a class="header" href="#12-related-api">1.2 Related API</a></h3>
<p>The methods used to set tags are:</p>
<pre><code class="language-java">public void setTagNull(int index, int type)
public void setTagBoolean(int index, boolean value)
public void setTagInt(int index, int value)
public void setTagByte(int index, byte value)
public void setTagShort(int index, short value)
public void setTagLong(int index, long value)
public void setTagTimestamp(int index, long value)
public void setTagFloat(int index, float value)
public void setTagDouble(int index, double value)
public void setTagString(int index, String value)
public void setTagNString(int index, String value)
</code></pre>
<p>The methods used to set columns are:</p>
<pre><code class="language-java">public void setInt(int columnIndex, ArrayList&lt;Integer&gt; list) throws SQLException
public void setFloat(int columnIndex, ArrayList&lt;Float&gt; list) throws SQLException
public void setTimestamp(int columnIndex, ArrayList&lt;Long&gt; list) throws SQLException
public void setLong(int columnIndex, ArrayList&lt;Long&gt; list) throws SQLException
public void setDouble(int columnIndex, ArrayList&lt;Double&gt; list) throws SQLException
public void setBoolean(int columnIndex, ArrayList&lt;Boolean&gt; list) throws SQLException
public void setByte(int columnIndex, ArrayList&lt;Byte&gt; list) throws SQLException
public void setShort(int columnIndex, ArrayList&lt;Short&gt; list) throws SQLException
public void setString(int columnIndex, ArrayList&lt;String&gt; list, int size) throws SQLException
public void setNString(int columnIndex, ArrayList&lt;String&gt; list, int size) throws SQLException
</code></pre>
<h2 id="2-upgrade-to-jdbc-driver-2036"><a class="header" href="#2-upgrade-to-jdbc-driver-2036">2. Upgrade to JDBC Driver 2.0.36</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.36</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h3 id="21-example-bind-different-tables-in-one-batch"><a class="header" href="#21-example-bind-different-tables-in-one-batch">2.1 Example: Bind Different Tables in One Batch</a></h3>
<p>You can insert into multiple tables in ont batch using param biding api now. It's a new feature of JdBC driver.
In the following example, we insert into three sub stables in one batch.</p>
<pre><code class="language-java">package com.taos.test;

import com.taosdata.jdbc.TSDBPreparedStatement;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Random;

public class TestBindMultiTable {
    private Random r = new Random();

    private Connection getConnection() throws SQLException {
        Connection conn = DriverManager.getConnection(&quot;jdbc:TAOS://127.0.0.1:6030&quot;, &quot;root&quot;, &quot;taosdata&quot;);
        return conn;
    }

    private void createTable(Connection conn) throws SQLException {
        try (Statement stmt = conn.createStatement()) {
            stmt.execute(&quot;drop database if exists java_test&quot;);
            stmt.execute(&quot;create database java_test&quot;);
            stmt.execute(&quot;use java_test&quot;);
            stmt.execute(&quot;create stable weather(ts timestamp, c1 int, c2 binary(10)) &quot; +
                    &quot;tags(no int, location binary(10))&quot;);
        }
    }

    public void run() throws SQLException {
        int numOfTables = 3;
        int numOfRows = 5;
        try (Connection conn = getConnection()) {
            createTable(conn);
            String psql = &quot;insert into ? using weather tags (?, ?) (ts, c1, c2) values(?, ?, ?)&quot;;
            try (TSDBPreparedStatement pst = (TSDBPreparedStatement) conn.prepareStatement(psql)) {
                for (int t = 0; t &lt; numOfTables; t++) {
                    // change sub table name
                    pst.setTableName(&quot;w&quot; + t);
                    // set tags
                    pst.setTagInt(0, r.nextInt(10));
                    pst.setTagString(1, &quot;City_&quot; + (t));
                    // set values
                    ArrayList&lt;Long&gt; ts = new ArrayList&lt;&gt;();
                    for (int i = 0; i &lt; numOfRows; i++) {
                        ts.add(System.currentTimeMillis() + i);
                    }
                    pst.setTimestamp(0, ts);
                    ArrayList&lt;Integer&gt; s1 = new ArrayList&lt;&gt;();
                    for (int i = 0; i &lt; numOfRows; i++) {
                        s1.add(r.nextInt(100));
                    }
                    pst.setInt(1, s1);
                    ArrayList&lt;String&gt; s2 = new ArrayList&lt;&gt;();
                    for (int i = 0; i &lt; numOfRows; i++) {
                        s2.add(&quot;test&quot; + r.nextInt(100));
                    }
                    pst.setString(2, s2, 10);
                    // The cache is not cleared after AddBatch. Do not bind new data again before ExecuteBatch
                    pst.columnDataAddBatch();
                }
                pst.columnDataExecuteBatch();
                pst.columnDataCloseBatch();
            }
        }
    }

    public static void main(String[] args) throws SQLException {
        TestBindMultiTable test = new TestBindMultiTable();
        test.run();
    }
}

</code></pre>
<pre><code class="language-cmd">
taos&gt; select * from java_test.weather;
           ts            |     c1      |     c2     |     no      |  location  |
================================================================================
 2021-12-24 11:00:15.736 |          72 | test14     |           3 | City_0     |
 2021-12-24 11:00:15.737 |          62 | test69     |           3 | City_0     |
 2021-12-24 11:00:15.738 |          46 | test39     |           3 | City_0     |
 2021-12-24 11:00:15.739 |          13 | test42     |           3 | City_0     |
 2021-12-24 11:00:15.740 |          75 | test72     |           3 | City_0     |
 2021-12-24 11:00:15.770 |          35 | test22     |           6 | City_1     |
 2021-12-24 11:00:15.771 |          44 | test95     |           6 | City_1     |
 2021-12-24 11:00:15.772 |           9 | test4      |           6 | City_1     |
 2021-12-24 11:00:15.773 |          72 | test51     |           6 | City_1     |
 2021-12-24 11:00:15.774 |          45 | test32     |           6 | City_1     |
 2021-12-24 11:00:15.778 |          42 | test10     |           8 | City_2     |
 2021-12-24 11:00:15.779 |          62 | test81     |           8 | City_2     |
 2021-12-24 11:00:15.780 |          71 | test4      |           8 | City_2     |
 2021-12-24 11:00:15.781 |          41 | test95     |           8 | City_2     |
 2021-12-24 11:00:15.782 |          66 | test73     |           8 | City_2     |
Query OK, 15 row(s) in set (0.066000s)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-python"><a class="header" href="#parameter-binding-with-python">Parameter Binding with Python</a></h1>
<h2 id="1-get-started-7"><a class="header" href="#1-get-started-7">1. Get Started</a></h2>
<ol>
<li>python: <code>3.10</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
</ol>
<h3 id="11-example-bind-one-by-one"><a class="header" href="#11-example-bind-one-by-one">1.1. Example: Bind One by One</a></h3>
<pre><code class="language-python">
import taos


def prepare():
    conn = taos.connect()
    try:
        conn.execute(&quot;drop database if exists pytest&quot;)
        conn.execute(&quot;create database pytest&quot;)
        conn.execute(&quot;create stable pytest.weather(ts timestamp, v int)&quot;
                     &quot; tags (loc binary(10))&quot;)
    finally:
        conn.close()


def test_bind_one_by_one():
    prepare()
    conn = taos.connect(database=&quot;pytest&quot;)
    stmt = conn.statement(&quot;insert into ? using weather tags (?) (ts, v) values(?, ?)&quot;)
    # set table name and tag value
    tags: taos.TaosBind = taos.new_bind_params(1)
    tags[0].binary('beijing')
    stmt.set_tbname_tags(&quot;weather_beijing&quot;, tags)

    # row 1
    params: taos.TaosBind = taos.new_bind_params(2)
    params[0].timestamp(1631517738426)
    params[1].int(100)
    stmt.bind_param(params)

    # row 2
    params2: taos.TaosBind = taos.new_bind_params(2)
    params2[0].timestamp(1631517739000)
    params2[1].int(200)
    stmt.bind_param(params2)

    stmt.execute()
    stmt.close()
    conn.close()


</code></pre>
<pre><code class="language-cmd">taos&gt; select tbname, * from pytest.weather;
             tbname             |           ts            |      v      |    loc     |
======================================================================================
 weather_beijing                | 2021-09-13 15:22:18.426 |         100 | beijing    |
 weather_beijing                | 2021-09-13 15:22:19.000 |         200 | beijing    |
Query OK, 2 row(s) in set (0.003549s)
</code></pre>
<h3 id="12-example-multi-binds"><a class="header" href="#12-example-multi-binds">1.2. Example: Multi Binds</a></h3>
<pre><code class="language-python">def test_multi_bind():
    prepare()
    conn = taos.connect(database=&quot;pytest&quot;)
    stmt = conn.statement(&quot;insert into ? using weather tags (?) (ts, v) values(?, ?)&quot;)
    # set table name and tag value
    tags: taos.TaosBind = taos.new_bind_params(1)
    tags[0].binary('shanghai')
    stmt.set_tbname_tags(&quot;weather_shanghai&quot;, tags)
    # bind values
    params: taos.TaosMultiBind = taos.new_multi_binds(2)
    params[0].timestamp([1631517738426, 1631517738526])
    params[1].int([100, 120])
    stmt.bind_param_batch(params)

    stmt.execute()
    stmt.close()
    conn.close()


</code></pre>
<pre><code class="language-cmd">taos&gt; select tbname, * from pytest.weather;
             tbname             |           ts            |      v      |    loc     |
======================================================================================
 weather_shanghai               | 2021-09-13 15:22:18.426 |         100 | shanghai   |
 weather_shanghai               | 2021-09-13 15:22:18.526 |         120 | shanghai   |
Query OK, 2 row(s) in set (0.006830s)
</code></pre>
<h3 id="13-example-bind-different-tables-in-one-batch"><a class="header" href="#13-example-bind-different-tables-in-one-batch">1.3. Example: Bind Different Tables in One Batch</a></h3>
<pre><code class="language-python">def test_change_table():
    prepare()
    conn = taos.connect(database=&quot;pytest&quot;)
    stmt = conn.statement(&quot;insert into ? using weather tags (?) (ts, v) values(?, ?)&quot;)
    for i in range(2):
        # change table name and tag values
        tags: taos.TaosBind = taos.new_bind_params(1)
        tags[0].binary('city_' + str(i))
        stmt.set_tbname_tags(&quot;weather_city_&quot; + str(i), tags)
        # bind values
        params: taos.TaosMultiBind = taos.new_multi_binds(2)
        params[0].timestamp([1631517738426, 1631517738526, 1631517739000])
        params[1].int([100, 120, 130])
        stmt.bind_param_batch(params)
        # bind values again
        params: taos.TaosMultiBind = taos.new_multi_binds(2)
        params[0].timestamp([1631517740426, 1631517741526, 1631517742000])
        params[1].int([140, 150, 160])
        stmt.bind_param_batch(params)

    stmt.execute()
    stmt.close()
    conn.close()
</code></pre>
<pre><code class="language-cmd">taos&gt; select tbname, * from pytest.weather;
             tbname             |           ts            |      v      |    loc     |
======================================================================================
 weather_city_0                 | 2021-09-13 15:22:18.426 |         100 | city_0     |
 weather_city_0                 | 2021-09-13 15:22:18.526 |         120 | city_0     |
 weather_city_0                 | 2021-09-13 15:22:19.000 |         130 | city_0     |
 weather_city_0                 | 2021-09-13 15:22:20.426 |         130 | city_0     |
 weather_city_0                 | 2021-09-13 15:22:21.526 |         140 | city_0     |
 weather_city_0                 | 2021-09-13 15:22:22.000 |         150 | city_0     |
 weather_city_1                 | 2021-09-13 15:22:18.426 |         100 | city_1     |
 weather_city_1                 | 2021-09-13 15:22:18.526 |         120 | city_1     |
 weather_city_1                 | 2021-09-13 15:22:19.000 |         130 | city_1     |
 weather_city_1                 | 2021-09-13 15:22:20.426 |         130 | city_1     |
 weather_city_1                 | 2021-09-13 15:22:21.526 |         140 | city_1     |
 weather_city_1                 | 2021-09-13 15:22:22.000 |         150 | city_1     |
Query OK, 12 row(s) in set (0.006428s)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-go"><a class="header" href="#parameter-binding-with-go">Parameter Binding with Go</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-c"><a class="header" href="#parameter-binding-with-c">Parameter Binding with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-rust"><a class="header" href="#parameter-binding-with-rust">Parameter Binding with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter-binding-with-c-1"><a class="header" href="#parameter-binding-with-c-1">Parameter Binding with C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing"><a class="header" href="#schemaless-writing">Schemaless Writing</a></h1>
<p>Since version 2.3.0.0, TDengine support several schemaless writing protocols, including:</p>
<ol>
<li>InfluxDB Line Protocol</li>
<li>OpenTSDB telnet Protocol</li>
<li>OpenTSDB JSON Protocol</li>
</ol>
<p>In this way, super table and it's sub tables will be created automatically as needed. </p>
<h2 id="1-influxdb-line-protocol"><a class="header" href="#1-influxdb-line-protocol">1. InfluxDB Line Protocol</a></h2>
<p><strong>Syntax:</strong></p>
<pre><code class="language-txt">measurementName,tagKey=tagValue fieldKey=&quot;fieldValue&quot; 1465839830100400200
--------------- --------------- --------------------- -------------------
       |               |                  |                    |
  Measurement       Tag set           Field set            Timestamp
</code></pre>
<p><strong>Example:</strong></p>
<pre><code class="language-txt">measurementName,tag1=value1,tag2=value2 fieldKey=&quot;fieldValue&quot; 1556813561098000000
</code></pre>
<p><strong>Reference:</strong> <a href="https://docs.influxdata.com/influxdb/v2.0/reference/syntax/line-protocol">line-protocol</a></p>
<h2 id="2-opentsdb-telnet-protocol"><a class="header" href="#2-opentsdb-telnet-protocol">2. OpenTSDB Telnet Protocol</a></h2>
<p><strong>Syntax:</strong></p>
<pre><code class="language-txt">put &lt;metric&gt; &lt;timestamp&gt; &lt;value&gt; &lt;tagk_1&gt;=&lt;tagv_1&gt;[ &lt;tagk_n&gt;=&lt;tagv_n&gt;]
</code></pre>
<p><strong>Example:</strong></p>
<pre><code class="language-txt">put sys.if.bytes.out 1479496100 1.3E3 host=web01 interface=eth0
put sys.procs.running 1479496100 42 host=web01
</code></pre>
<p><strong>Reference:</strong> <a href="http://opentsdb.net/docs/build/html/api_telnet/put.html">Telnet Style API</a></p>
<h2 id="3-opentsdb-json-protocol"><a class="header" href="#3-opentsdb-json-protocol">3. OpenTSDB JSON Protocol</a></h2>
<p><strong>Example:</strong></p>
<pre><code class="language-json">[
    {
        &quot;metric&quot;: &quot;sys.cpu.nice&quot;,
        &quot;timestamp&quot;: 1346846400,
        &quot;value&quot;: 18,
        &quot;tags&quot;: {
           &quot;host&quot;: &quot;web01&quot;,
           &quot;dc&quot;: &quot;lga&quot;
        }
    },
    {
        &quot;metric&quot;: &quot;sys.cpu.nice&quot;,
        &quot;timestamp&quot;: 1346846400,
        &quot;value&quot;: 9,
        &quot;tags&quot;: {
           &quot;host&quot;: &quot;web02&quot;,
           &quot;dc&quot;: &quot;lga&quot;
        }
    }
]
</code></pre>
<p><strong>Reference:</strong> <a href="http://opentsdb.net/docs/build/html/api_http/put.html">HTTP API</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-java"><a class="header" href="#schemaless-writing-with-java">Schemaless Writing with Java</a></h1>
<h2 id="1-get-started-8"><a class="header" href="#1-get-started-8">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.36</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h3 id="11-example--opentsdb-telnet-protocol"><a class="header" href="#11-example--opentsdb-telnet-protocol">1.1 Example:  OpenTSDB Telnet Protocol</a></h3>
<p>In this example, we started 3 threads and each of them wrote 5 rows.</p>
<pre><code class="language-java">package com.taos.test;

import com.taosdata.jdbc.SchemalessWriter;
import com.taosdata.jdbc.enums.SchemalessProtocolType;
import com.taosdata.jdbc.enums.SchemalessTimestampType;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.atomic.AtomicInteger;

public class TestTelnet {
    private AtomicInteger tbId = new AtomicInteger();

    public void prepare() {
        try(Connection conn = DriverManager.getConnection(
                &quot;jdbc:TAOS://127.0.0.1:6030/&quot;,
                &quot;root&quot;,
                &quot;taosdata&quot;)) {
            try(Statement stmt = conn.createStatement()) {
                stmt.execute(&quot;drop database if exists test_telnet&quot;);
                stmt.execute(&quot;create database if not exists test_telnet&quot;);
                stmt.execute(&quot;use test_telnet&quot;);
            }
        } catch (SQLException e) {
            System.out.println(e);
        }
    }

    public void insert() {
        int id = tbId.incrementAndGet();
        int rowCount = 5;
        Random random = new Random();
        try(Connection conn = DriverManager.getConnection(
                &quot;jdbc:TAOS://127.0.0.1:6030/test_telnet&quot;,
                &quot;root&quot;,
                &quot;taosdata&quot;)) {
            SchemalessWriter writer = new SchemalessWriter(conn);
            long ts = System.currentTimeMillis() - rowCount;
            for (int i = 0; i &lt; rowCount; ++i) {
                String line = &quot;stb &quot; + (ts + i) + &quot; &quot; + random.nextDouble()   +&quot;  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_&quot; + id;
                System.out.println(line);
                writer.write(line,
                        SchemalessProtocolType.TELNET,
                        SchemalessTimestampType.MILLI_SECONDS);
            }
        } catch (SQLException e) {
            System.out.println(e);
        }
    }

    public static void main(String[] args) throws InterruptedException {
        TestTelnet testTelnet = new TestTelnet();
        testTelnet.prepare();
        Thread.sleep(1000);
        List&lt;Thread&gt; threadList = new ArrayList&lt;&gt;();
        for (int i = 0; i &lt; 3; i++) {
            Thread t = new Thread(testTelnet::insert);
            t.start();
            threadList.add(t);
        }
        for (Thread t: threadList) {
            t.join();
        }
    }
}
</code></pre>
<p><strong>Stdout:</strong></p>
<pre><code class="language-cmd">stb 1640857612061 0.6460522154610073  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_1
stb 1640857612066 0.969971940984538  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_3
stb 1640857612067 0.5870601504696565  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_2
stb 1640857612067 0.21461395470578837  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_3
stb 1640857612068 0.08874585300450155  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_3
stb 1640857612069 0.7481226428021521  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_3
stb 1640857612070 0.24020073815383125  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_3
stb 1640857612068 0.10163593658989856  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_2
stb 1640857612069 0.5926218791374347  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_2
stb 1640857612070 0.13807264946787146  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_2
stb 1640857612071 0.5863871396282755  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_2
stb 1640857612062 0.21880317057457355  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_1
stb 1640857612063 0.906689126172944  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_1
stb 1640857612064 0.7554074425155068  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_1
stb 1640857612065 0.586732103206889  tagk1=BINARY-tagvalue tagk2=BINARY-tagvalue id=tb_1
</code></pre>
<p><strong>Data in database:</strong></p>
<pre><code class="language-cmd">taos&gt; select * from test_telnet.stb;
           ts            |           value           |        id        |             tagk1              |             tagk2              |
===========================================================================================================================================
 2021-12-30 17:46:52.067 |               0.587060150 | tb_2             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.068 |               0.101635937 | tb_2             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.069 |               0.592621879 | tb_2             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.070 |               0.138072649 | tb_2             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.071 |               0.586387140 | tb_2             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.061 |               0.646052215 | tb_1             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.062 |               0.218803171 | tb_1             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.063 |               0.906689126 | tb_1             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.064 |               0.755407443 | tb_1             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.065 |               0.586732103 | tb_1             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.066 |               0.969971941 | tb_3             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.067 |               0.214613955 | tb_3             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.068 |               0.088745853 | tb_3             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.069 |               0.748122643 | tb_3             | BINARY-tagvalue                | BINARY-tagvalue                |
 2021-12-30 17:46:52.070 |               0.240200738 | tb_3             | BINARY-tagvalue                | BINARY-tagvalue                |
Query OK, 15 row(s) in set (0.174000s)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-python"><a class="header" href="#schemaless-writing-with-python">Schemaless Writing with Python</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-go"><a class="header" href="#schemaless-writing-with-go">Schemaless Writing with Go</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-nodejs"><a class="header" href="#schemaless-writing-with-nodejs">Schemaless Writing with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-c"><a class="header" href="#schemaless-writing-with-c">Schemaless Writing with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-rust"><a class="header" href="#schemaless-writing-with-rust">Schemaless Writing with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-c-1"><a class="header" href="#schemaless-writing-with-c-1">Schemaless Writing with C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schemaless-writing-with-lua"><a class="header" href="#schemaless-writing-with-lua">Schemaless Writing with Lua</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription"><a class="header" href="#subscription">Subscription</a></h1>
<p>The subscription API currently supports subscribing to one or more tables and continuously obtaining the latest data written to the tables through regular polling.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription-with-java"><a class="header" href="#subscription-with-java">Subscription with Java</a></h1>
<h2 id="1-get-started-9"><a class="header" href="#1-get-started-9">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.34</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
</ol>
<h3 id="11-usage"><a class="header" href="#11-usage">1.1. Usage</a></h3>
<pre><code class="language-java">TSDBSubscribe sub = ((TSDBConnection)conn).subscribe(topic, sql, restart);
</code></pre>
<ul>
<li>topic: <code>String</code>. the unique identifier of a subscription</li>
<li>sql: <code>String</code>. A select expression for this subscription</li>
<li>restart: <code>boolean</code>. <code>true</code> mean subscribe from the beginning; <code>false</code> means subscribe from last stopped place. </li>
</ul>
<pre><code class="language-java">sub.close(keepProcess);
</code></pre>
<ul>
<li>keepProcess: <code>boolean</code>. If the parameter is true, the subscription progress information is reserved, and a subscription with the same name can be created later to continue consuming data. If false, the subscription progress is not retained.</li>
</ul>
<h3 id="12-example"><a class="header" href="#12-example">1.2. Example</a></h3>
<p>In this example, we have two threads: one for producing another for consuming. The producing thread insert one record every 100 milliseconds, and the consuming thread consumes once every 1000 milliseconds.</p>
<pre><code class="language-java">package com.taos.tdjava;

import com.taosdata.jdbc.TSDBConnection;
import com.taosdata.jdbc.TSDBResultSet;
import com.taosdata.jdbc.TSDBSubscribe;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class TestSubscription {

    Connection getConnection() throws SQLException {
        String jdbcUrl = &quot;jdbc:TAOS://localhost:6030/test?user=root&amp;password=taosdata&quot;;
        Connection conn = DriverManager.getConnection(jdbcUrl);
        return conn;
    }

    void startWrite() {
        try (Connection conn = getConnection()) {
            try (Statement stmt = conn.createStatement()) {
                stmt.executeUpdate(&quot;drop table if exists tb_sub&quot;);
                stmt.executeUpdate(&quot;create table tb_sub(ts timestamp, c1 int)&quot;);
                long ts = System.currentTimeMillis() - 10000;
                for (int i = 0; i &lt; 100; i++, ts += 100) {
                    stmt.executeUpdate(&quot;insert into tb_sub values(&quot; + ts + &quot;, &quot; + i + &quot;)&quot;);
                    Thread.sleep(100); // write every 100 milliseconds
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    void startSubscribe() throws SQLException, InterruptedException {
        Thread.sleep(500); // wait for some data.
        try (Connection conn = getConnection()) {
            TSDBSubscribe sub = ((TSDBConnection) conn).subscribe(&quot;test_topic&quot;, &quot;select * from tb_sub&quot;, true);
            int total = 0;
            while (true) {
                TSDBResultSet rs = sub.consume();
                int count = 0;
                while (rs.next()) {
                    count++;
                    System.out.println(rs.getTimestamp(1) + &quot;, &quot; + rs.getInt(2));
                }
                total += count;
                System.out.printf(&quot;==================%d rows consumed, total %d================\n&quot;, count, total);
                Thread.sleep(1000); // subscribe every 1000 milliseconds
                // stop when no more data
                if (count == 0) {
                    rs.close();
                    sub.close(true);
                    break;
                }
            }
        }
    }

    public static void main(String[] args) throws SQLException, InterruptedException {
        TestSubscription test = new TestSubscription();
        Thread writeThread = new Thread(test::startWrite);
        writeThread.start();
        test.startSubscribe();
    }
}
</code></pre>
<pre><code class="language-cmd">&quot;C:\Program Files\Java\jdk1.8.0_271\bin\java.exe&quot; com.taos.tdjava.TestSubscription
2021-12-08 12:00:38.872, 0
2021-12-08 12:00:38.972, 1
2021-12-08 12:00:39.072, 2
2021-12-08 12:00:39.172, 3
==================4 rows consumed, total 4================
2021-12-08 12:00:39.272, 4
2021-12-08 12:00:39.372, 5
2021-12-08 12:00:39.472, 6
2021-12-08 12:00:39.572, 7
2021-12-08 12:00:39.672, 8
2021-12-08 12:00:39.772, 9
2021-12-08 12:00:39.872, 10
2021-12-08 12:00:39.972, 11
2021-12-08 12:00:40.072, 12
2021-12-08 12:00:40.172, 13
==================10 rows consumed, total 14================
2021-12-08 12:00:40.272, 14
2021-12-08 12:00:40.372, 15
2021-12-08 12:00:40.472, 16
2021-12-08 12:00:40.572, 17
2021-12-08 12:00:40.672, 18
2021-12-08 12:00:40.772, 19
2021-12-08 12:00:40.872, 20
2021-12-08 12:00:40.972, 21
2021-12-08 12:00:41.072, 22
2021-12-08 12:00:41.172, 23
==================10 rows consumed, total 24================
2021-12-08 12:00:41.272, 24
2021-12-08 12:00:41.372, 25
2021-12-08 12:00:41.472, 26
2021-12-08 12:00:41.572, 27
2021-12-08 12:00:41.672, 28
2021-12-08 12:00:41.772, 29
2021-12-08 12:00:41.872, 30
2021-12-08 12:00:41.972, 31
2021-12-08 12:00:42.072, 32
2021-12-08 12:00:42.172, 33
==================10 rows consumed, total 34================
2021-12-08 12:00:42.272, 34
2021-12-08 12:00:42.372, 35
2021-12-08 12:00:42.472, 36
2021-12-08 12:00:42.572, 37
2021-12-08 12:00:42.672, 38
2021-12-08 12:00:42.772, 39
2021-12-08 12:00:42.872, 40
2021-12-08 12:00:42.972, 41
2021-12-08 12:00:43.072, 42
2021-12-08 12:00:43.172, 43
==================10 rows consumed, total 44================
2021-12-08 12:00:43.272, 44
2021-12-08 12:00:43.372, 45
2021-12-08 12:00:43.472, 46
2021-12-08 12:00:43.572, 47
2021-12-08 12:00:43.672, 48
2021-12-08 12:00:43.772, 49
2021-12-08 12:00:43.872, 50
2021-12-08 12:00:43.972, 51
2021-12-08 12:00:44.072, 52
2021-12-08 12:00:44.172, 53
==================10 rows consumed, total 54================
2021-12-08 12:00:44.272, 54
2021-12-08 12:00:44.372, 55
2021-12-08 12:00:44.472, 56
2021-12-08 12:00:44.572, 57
2021-12-08 12:00:44.672, 58
2021-12-08 12:00:44.772, 59
2021-12-08 12:00:44.872, 60
2021-12-08 12:00:44.972, 61
2021-12-08 12:00:45.072, 62
2021-12-08 12:00:45.172, 63
==================10 rows consumed, total 64================
2021-12-08 12:00:45.272, 64
2021-12-08 12:00:45.372, 65
2021-12-08 12:00:45.472, 66
2021-12-08 12:00:45.572, 67
2021-12-08 12:00:45.672, 68
2021-12-08 12:00:45.772, 69
2021-12-08 12:00:45.872, 70
2021-12-08 12:00:45.972, 71
2021-12-08 12:00:46.072, 72
2021-12-08 12:00:46.172, 73
==================10 rows consumed, total 74================
2021-12-08 12:00:46.272, 74
2021-12-08 12:00:46.372, 75
2021-12-08 12:00:46.472, 76
2021-12-08 12:00:46.572, 77
2021-12-08 12:00:46.672, 78
2021-12-08 12:00:46.772, 79
2021-12-08 12:00:46.872, 80
2021-12-08 12:00:46.972, 81
2021-12-08 12:00:47.072, 82
==================9 rows consumed, total 83================
2021-12-08 12:00:47.172, 83
2021-12-08 12:00:47.272, 84
2021-12-08 12:00:47.372, 85
2021-12-08 12:00:47.472, 86
2021-12-08 12:00:47.572, 87
2021-12-08 12:00:47.672, 88
2021-12-08 12:00:47.772, 89
2021-12-08 12:00:47.872, 90
2021-12-08 12:00:47.972, 91
2021-12-08 12:00:48.072, 92
==================10 rows consumed, total 93================
2021-12-08 12:00:48.172, 93
2021-12-08 12:00:48.272, 94
2021-12-08 12:00:48.372, 95
2021-12-08 12:00:48.472, 96
2021-12-08 12:00:48.572, 97
2021-12-08 12:00:48.672, 98
2021-12-08 12:00:48.772, 99
==================7 rows consumed, total 100================
==================0 rows consumed, total 100================

Process finished with exit code 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription-with-python"><a class="header" href="#subscription-with-python">Subscription with Python</a></h1>
<h2 id="1-get-started-10"><a class="header" href="#1-get-started-10">1. Get Started</a></h2>
<ol>
<li>python: <code>3.9</code></li>
<li>taospy: <code>2.1.2</code></li>
<li>TDengine 2.2.1.3</li>
<li>Ubuntu 18.04.5 LTS</li>
</ol>
<p><strong>Note:</strong> Below examples not work on Windows System.</p>
<h3 id="11-example-synchronous-subscription"><a class="header" href="#11-example-synchronous-subscription">1.1. Example: Synchronous Subscription</a></h3>
<pre><code class="language-python">import time
from threading import Thread

import taos


def prepare():
    conn = taos.connect()
    conn.execute(&quot;drop database if exists pytest&quot;)
    conn.execute(&quot;create database pytest&quot;)
    conn.execute(&quot;create table pytest.tb_sub(ts timestamp, c1 int)&quot;)


def write():
    &quot;&quot;&quot;
    write 100 rows, 10 rows per second.
    &quot;&quot;&quot;
    conn = taos.connect(database=&quot;pytest&quot;)
    ts = int(time.time() * 1000) - 10000
    for i in range(100):
        conn.execute(f&quot;insert into tb_sub values({ts}, {i})&quot;)
        ts += 100
        i += 1
        time.sleep(0.1)


def subscribe():
    conn = taos.connect(database=&quot;pytest&quot;)
    sub = conn.subscribe(True, &quot;test_topic&quot;, &quot;select * from tb_sub&quot;, 1000)
    print(&quot;# consume from begin&quot;)
    while True:
        print('----------------------------------------')
        result = sub.consume()
        rows = result.fetch_all()
        if result.row_count &gt; 0:
            for ts, n in rows:
                print(ts, n)
        else:
            sub.close()
            break
        time.sleep(1)


if __name__ == '__main__':
    prepare()
    Thread(target=write).start()
    Thread(target=subscribe).start()
</code></pre>
<pre><code class="language-cmd"># consume from begin
----------------------------------------
2021-12-21 15:35:08.284000 0
----------------------------------------
2021-12-21 15:35:08.384000 1
2021-12-21 15:35:08.484000 2
2021-12-21 15:35:08.584000 3
2021-12-21 15:35:08.684000 4
2021-12-21 15:35:08.784000 5
2021-12-21 15:35:08.884000 6
2021-12-21 15:35:08.984000 7
2021-12-21 15:35:09.084000 8
2021-12-21 15:35:09.184000 9
----------------------------------------
2021-12-21 15:35:09.284000 10
2021-12-21 15:35:09.384000 11
2021-12-21 15:35:09.484000 12
2021-12-21 15:35:09.584000 13
2021-12-21 15:35:09.684000 14
2021-12-21 15:35:09.784000 15
2021-12-21 15:35:09.884000 16
2021-12-21 15:35:09.984000 17
2021-12-21 15:35:10.084000 18
2021-12-21 15:35:10.184000 19
----------------------------------------
2021-12-21 15:35:10.284000 20
2021-12-21 15:35:10.384000 21
2021-12-21 15:35:10.484000 22
2021-12-21 15:35:10.584000 23
2021-12-21 15:35:10.684000 24
2021-12-21 15:35:10.784000 25
2021-12-21 15:35:10.884000 26
2021-12-21 15:35:10.984000 27
2021-12-21 15:35:11.084000 28
2021-12-21 15:35:11.184000 29
----------------------------------------
2021-12-21 15:35:11.284000 30
2021-12-21 15:35:11.384000 31
2021-12-21 15:35:11.484000 32
2021-12-21 15:35:11.584000 33
2021-12-21 15:35:11.684000 34
2021-12-21 15:35:11.784000 35
2021-12-21 15:35:11.884000 36
2021-12-21 15:35:11.984000 37
2021-12-21 15:35:12.084000 38
2021-12-21 15:35:12.184000 39
----------------------------------------
2021-12-21 15:35:12.284000 40
2021-12-21 15:35:12.384000 41
2021-12-21 15:35:12.484000 42
2021-12-21 15:35:12.584000 43
2021-12-21 15:35:12.684000 44
2021-12-21 15:35:12.784000 45
2021-12-21 15:35:12.884000 46
2021-12-21 15:35:12.984000 47
2021-12-21 15:35:13.084000 48
2021-12-21 15:35:13.184000 49
----------------------------------------
2021-12-21 15:35:13.284000 50
2021-12-21 15:35:13.384000 51
2021-12-21 15:35:13.484000 52
2021-12-21 15:35:13.584000 53
2021-12-21 15:35:13.684000 54
2021-12-21 15:35:13.784000 55
2021-12-21 15:35:13.884000 56
2021-12-21 15:35:13.984000 57
2021-12-21 15:35:14.084000 58
2021-12-21 15:35:14.184000 59
----------------------------------------
2021-12-21 15:35:14.284000 60
2021-12-21 15:35:14.384000 61
2021-12-21 15:35:14.484000 62
2021-12-21 15:35:14.584000 63
2021-12-21 15:35:14.684000 64
2021-12-21 15:35:14.784000 65
2021-12-21 15:35:14.884000 66
2021-12-21 15:35:14.984000 67
2021-12-21 15:35:15.084000 68
2021-12-21 15:35:15.184000 69
----------------------------------------
2021-12-21 15:35:15.284000 70
2021-12-21 15:35:15.384000 71
2021-12-21 15:35:15.484000 72
2021-12-21 15:35:15.584000 73
2021-12-21 15:35:15.684000 74
2021-12-21 15:35:15.784000 75
2021-12-21 15:35:15.884000 76
2021-12-21 15:35:15.984000 77
2021-12-21 15:35:16.084000 78
2021-12-21 15:35:16.184000 79
----------------------------------------
2021-12-21 15:35:16.284000 80
2021-12-21 15:35:16.384000 81
2021-12-21 15:35:16.484000 82
2021-12-21 15:35:16.584000 83
2021-12-21 15:35:16.684000 84
2021-12-21 15:35:16.784000 85
2021-12-21 15:35:16.884000 86
2021-12-21 15:35:16.984000 87
2021-12-21 15:35:17.084000 88
2021-12-21 15:35:17.184000 89
----------------------------------------
2021-12-21 15:35:17.284000 90
2021-12-21 15:35:17.384000 91
2021-12-21 15:35:17.484000 92
2021-12-21 15:35:17.584000 93
2021-12-21 15:35:17.684000 94
2021-12-21 15:35:17.784000 95
2021-12-21 15:35:17.884000 96
2021-12-21 15:35:17.984000 97
2021-12-21 15:35:18.084000 98
2021-12-21 15:35:18.184000 99
----------------------------------------
</code></pre>
<h3 id="12-example-asynchronous-subscription"><a class="header" href="#12-example-asynchronous-subscription">1.2. Example: Asynchronous Subscription</a></h3>
<pre><code class="language-python">from taos import *
import time


def subscribe_callback(p_sub, p_result, p_param, errno):
    print(&quot;# fetch in callback&quot;)
    result = TaosResult(p_result)
    result.check_error(errno)
    for row in result.rows_iter():
        ts, n = row()
        print(ts, n)


def test_subscribe_callback(conn):
    dbname = &quot;pytest_taos_subscribe_callback&quot;
    try:
        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.execute(&quot;create database if not exists %s&quot; % dbname)
        conn.select_db(dbname)
        conn.execute(&quot;create table if not exists log(ts timestamp, n int)&quot;)

        print(&quot;# subscribe with callback&quot;)
        sub = conn.subscribe(False, &quot;test&quot;, &quot;select * from log&quot;,
                             1000, subscribe_callback)

        for i in range(10):
            conn.execute(&quot;insert into log values(now, %d)&quot; % i)
            time.sleep(0.7)
        sub.close()

        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.close()
    except Exception as err:
        conn.execute(&quot;drop database if exists %s&quot; % dbname)
        conn.close()
        raise err


if __name__ == &quot;__main__&quot;:
    test_subscribe_callback(connect())
</code></pre>
<pre><code class="language-cmd"># subscribe with callback
# fetch in callback
2021-12-21 15:32:07.483000 0
2021-12-21 15:32:08.184000 1
# fetch in callback
2021-12-21 15:32:08.884000 2
# fetch in callback
2021-12-21 15:32:09.585000 3
2021-12-21 15:32:10.286000 4
# fetch in callback
2021-12-21 15:32:10.987000 5
# fetch in callback
2021-12-21 15:32:11.688000 6
2021-12-21 15:32:12.389000 7
# fetch in callback
2021-12-21 15:32:13.090000 8
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription-with-go"><a class="header" href="#subscription-with-go">Subscription with Go</a></h1>
<h2 id="1-get-started-11"><a class="header" href="#1-get-started-11">1. Get Started</a></h2>
<ol>
<li>go: <code>1.17.2</code></li>
<li>driver-go: <code>v2.0.0</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h2 id="11-example-monitor-login-log"><a class="header" href="#11-example-monitor-login-log">1.1 Example: Monitor Login Log</a></h2>
<pre><code class="language-go">package main

import (
	&quot;database/sql/driver&quot;
	&quot;fmt&quot;
	&quot;io&quot;
	&quot;os&quot;
	&quot;time&quot;

	taos &quot;github.com/taosdata/driver-go/v2/af&quot;
)

func main() {
	db, err := taos.Open(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;log&quot;, 0)
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}
	defer db.Close()
	topic, err := db.Subscribe(false, &quot;taoslogtail&quot;, &quot;select ts, level, ipaddr, content from log&quot;, time.Second)
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(2)
	}
	defer topic.Unsubscribe(true)
	for {
		func() {
			rows, err := topic.Consume()
			defer func() { rows.Close(); time.Sleep(time.Second) }()
			if err != nil {
				fmt.Println(err)
				os.Exit(3)
			}
			for {
				values := make([]driver.Value, 4)
				err := rows.Next(values)
				if err == io.EOF {
					break
				} else if err != nil {
					fmt.Fprintln(os.Stderr, err)
					os.Exit(4)
				}
				ts := values[0].(time.Time)
				level := values[1].(int8)
				ipaddr := values[2].(string)
				content := values[3].(string)
				fmt.Printf(&quot;%s %d %s %s\n&quot;, ts.Format(time.StampMilli), level, ipaddr, content)
			}
		}()
	}
}
</code></pre>
<pre><code class="language-cmd">Dec 24 08:38:33.301 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:55.882 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:56.401 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:56.911 2 localhost:6030 user:root login from 127.0.0.1, result:Invalid database name
Dec 24 08:47:57.420 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:57.896 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:58.406 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:58.416 0 localhost:6030 db:0.pytest, is created by root
Dec 24 08:47:58.448 0 localhost:6030 db:0.pytest, is dropped by root
Dec 24 08:47:58.906 0 localhost:6030 user:root login from 127.0.0.1, result:success
Dec 24 08:47:58.914 0 localhost:6030 db:0.pytest, is created by root
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription-with-c"><a class="header" href="#subscription-with-c">Subscription with C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription-with-nodejs"><a class="header" href="#subscription-with-nodejs">Subscription with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-nanoseconds"><a class="header" href="#use-nanoseconds">Use Nanoseconds</a></h1>
<p>Before version 2.0.18.0, timestamp starts from 1970-01-01 00:00:00.000 (UTC/GMT)，earlier timestamp is not allowed. From version 2.0.18.0, this restriction is removed.
From version 2.1.5.0, time precision nanosecond is supported.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nanoseconds-in-java"><a class="header" href="#nanoseconds-in-java">Nanoseconds in Java</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type"><a class="header" href="#json-type">JSON Type</a></h1>
<h2 id="get-started-3"><a class="header" href="#get-started-3">Get Started</a></h2>
<p>From TDengine-2.4.0.0, TAG with JSON type can be used. The maximum length of JSON tag is 16k. The JSON value of a JSON tag could not have nested JSON object. Only one JSON tag is allowed and JSON tag can't co-exists with other tags. This is, if your table have a JSON tag, then it can't have other tags.</p>
<pre><code class="language-sql">taos&gt; create database test;
Query OK, 0 of 0 row(s) in database (0.010000s)

taos&gt; use test;
Query OK, 0 of 0 row(s) in database (0.002000s)

taos&gt; create stable s1(ts timestamp, v1 int) tags(info json);
Query OK, 0 of 0 row(s) in database (0.009000s)

taos&gt; create table s1_1 using s1 tags('{&quot;k1&quot;: &quot;v1&quot;}');
Query OK, 0 of 0 row(s) in database (0.034000s)

taos&gt; insert into s1_1 values(now, 1);
Query OK, 1 of 1 row(s) in database (0.005000s)

taos&gt; select * from s1 where info-&gt;'k1' = 'v1';
           ts            |     v1      |              info              |
=========================================================================
 2021-12-24 09:27:20.867 |           1 | {&quot;k1&quot;:&quot;v1&quot;}                    |
Query OK, 1 row(s) in set (0.024000s)

taos&gt; select info-&gt;'k1' from s1;
           info-&gt;'k1'           |
=================================
 &quot;v1&quot;                           |
Query OK, 1 row(s) in set (0.015000s)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-java"><a class="header" href="#json-type-support-in-java">JSON Type Support in Java</a></h1>
<h2 id="1-get-started-12"><a class="header" href="#1-get-started-12">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.36</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h3 id="11-example-use-json-tag"><a class="header" href="#11-example-use-json-tag">1.1 Example: Use JSON Tag</a></h3>
<ol>
<li>create a stable with JSON tag.</li>
<li>create s table using the stable;</li>
<li>select tag info.</li>
</ol>
<pre><code class="language-java">package com.taos.test;

import java.sql.*;

public class TestJSONTag {

    void printResult(ResultSet resultSet) throws SQLException {
        ResultSetMetaData metaData = resultSet.getMetaData();
        while (resultSet.next()) {
            for (int i = 1; i &lt;= metaData.getColumnCount(); i++) {
                String columnLabel = metaData.getColumnLabel(i);
                String value = resultSet.getString(i);
                System.out.printf(&quot;%s: %s\t&quot;, columnLabel, value);
            }
            System.out.println();
        }

    }

    void runJsonTagExample() throws SQLException {
        try (Connection conn = DriverManager.getConnection(&quot;jdbc:TAOS://&quot;,
                &quot;root&quot;,
                &quot;taosdata&quot;)) {
            try (Statement stmt = conn.createStatement()) {
                stmt.execute(&quot;create database java_test&quot;);
                stmt.execute(&quot;use java_test&quot;);
                stmt.execute(&quot;create stable s1(ts timestamp, v1 int) tags(info json)&quot;);
                stmt.execute(&quot;create table s1_1 using s1 tags('{\&quot;k1\&quot;: \&quot;v1\&quot;}')&quot;);
                ResultSet rs = stmt.executeQuery(&quot;select info, tbname from s1&quot;);
                printResult(rs);
                rs = stmt.executeQuery(&quot;select info-&gt;'k1' as k1 from s1&quot;);
                printResult(rs);
                stmt.execute(&quot;drop database java_test&quot;);
            }
        }
    }

    public static void main(String[] args) throws SQLException {
        TestJSONTag testJSONTag = new TestJSONTag();
        testJSONTag.runJsonTagExample();
    }
}
</code></pre>
<pre><code class="language-cmd">info: {&quot;k1&quot;:&quot;v1&quot;}	tbname: s1_1	
k1: &quot;v1&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-python"><a class="header" href="#json-type-support-in-python">JSON Type Support in Python</a></h1>
<h2 id="1-get-started-13"><a class="header" href="#1-get-started-13">1. Get Started</a></h2>
<ol>
<li>Python: <code>3.10.0</code></li>
<li>taospy: <code>2.2.0</code></li>
<li>TDengine: <code>2.4.0.0</code></li>
</ol>
<h3 id="11-example-use-json-tag-1"><a class="header" href="#11-example-use-json-tag-1">1.1 Example: Use JSON Tag</a></h3>
<pre><code class="language-python">import taos


def json_tag_example():
    conn = taos.connect()
    conn.execute(&quot;create database  py_test_json_type&quot;)
    conn.execute(&quot;use py_test_json_type&quot;)

    # create stable
    conn.execute(&quot;create stable s1 (ts timestamp, v1 int) tags (info json)&quot;)
    # create table
    conn.execute('''create table s1_1 using s1 tags ('{&quot;k1&quot;: &quot;v1&quot;}')''')
    # select tag value as a whole
    tags = conn.query(&quot;select info, tbname from s1&quot;).fetch_all_into_dict()
    print(tags)
    # select value of a specific key
    k1 = conn.query(&quot;select info-&gt;'k1' as k1 from s1&quot;).fetch_all_into_dict()
    print(k1)

    conn.query(&quot;drop database py_test_json_type&quot;)


if __name__ == '__main__':
    json_tag_example()
</code></pre>
<pre><code class="language-cmd">[{'info': '{&quot;k1&quot;:&quot;v1&quot;}', 'tbname': 's1_1'}]
[{'k1': '&quot;v1&quot;'}]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-go"><a class="header" href="#json-type-support-in-go">JSON Type Support in Go</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-nodejs"><a class="header" href="#json-type-support-in-nodejs">JSON Type Support in Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-c"><a class="header" href="#json-type-support-in-c">JSON Type Support in C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-rust"><a class="header" href="#json-type-support-in-rust">JSON Type Support in Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type-support-in-c-1"><a class="header" href="#json-type-support-in-c-1">JSON Type Support in C#</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="restful-api"><a class="header" href="#restful-api">Restful API</a></h1>
<p>TDengine's Restful API enable you access TDengine server directly using HTTP requests without installing TDengine client. So it's maybe the most convenient way to use TDengine. Let's test it using <code>curl</code> command.</p>
<h2 id="1-get-started-14"><a class="header" href="#1-get-started-14">1. Get Started</a></h2>
<p><strong>Test environment</strong></p>
<ol>
<li>TDengine: <code>2.2.1.3</code></li>
<li><code>curl</code> in <code>Git Bash</code> command line tool on windows system.</li>
</ol>
<h3 id="11-login"><a class="header" href="#11-login">1.1. Login</a></h3>
<p>Firstly, try the simplest command.</p>
<pre><code class="language-bash">$ curl http://localhost:6041
{&quot;status&quot;:&quot;error&quot;,&quot;code&quot;:4353,&quot;desc&quot;:&quot;url is not support&quot;}
</code></pre>
<p>Error as expected, the right path should be <code>/rest/sql</code>, let's try again:</p>
<pre><code class="language-bash">$ curl http://localhost:6041/rest/sql
{&quot;status&quot;:&quot;error&quot;,&quot;code&quot;:4357,&quot;desc&quot;:&quot;no auth info input&quot;}
</code></pre>
<p>Good reminding, we have not login yet. We can login by two ways:</p>
<p>First,visit <code>/rest/login/user/password</code>.</p>
<pre><code class="language-bash">$ curl http://localhost:6041/rest/login/root/taosdata
{
&quot;status&quot;:&quot;succ&quot;,
&quot;code&quot;:0,
&quot;desc&quot;:&quot;/KfeAzX/f9na8qdtNZmtONryp201ma04bEl8LcvLUd7a8qdtNZmtONryp201ma04&quot;
}
</code></pre>
<p>Second, visit <code>/rest/login/</code> with <code>-u user:password</code> option.</p>
<pre><code class="language-bash">$ curl -u root:taosdata http://localhost:6041/rest/login
{
    &quot;status&quot;:&quot;succ&quot;,
    &quot;code&quot;:0,
    &quot;desc&quot;:&quot;/KfeAzX/f9na8qdtNZmtONryp201ma04bEl8LcvLUd7a8qdtNZmtONryp201ma04&quot;
}
</code></pre>
<p><code>/KfeAzX/f9na8qdtNZmtONryp201ma04bEl8LcvLUd7a8qdtNZmtONryp201ma04</code> is the auth token, we can use later.</p>
<h3 id="12-example-show-databases"><a class="header" href="#12-example-show-databases">1.2. Example: Show Databases</a></h3>
<pre><code class="language-bash">curl -d &quot;show databases&quot; -H &quot;Authorization: Taosd /KfeAzX/f9na8qdtNZmtONryp201ma04bEl8LcvLUd7a8qdtNZmtONryp201ma04&quot; http://localhost:6041/rest/sql
</code></pre>
<pre><code class="language-json">{ 
    &quot;status&quot;:&quot;succ&quot;,
    &quot;head&quot;:[&quot;name&quot;,&quot;created_time&quot;,&quot;ntables&quot;,&quot;vgroups&quot;,&quot;replica&quot;,...],
    &quot;column_meta&quot;:[
        [&quot;name&quot;,8,32],
        [&quot;created_time&quot;,9,8],
        [&quot;ntables&quot;,4,4],
        [&quot;vgroups&quot;,4,4],
        [&quot;replica&quot;,3,2],
        ...
    &quot;data&quot;:[[&quot;test&quot;,&quot;2021-11-26 13:46:31.366&quot;,1132,2,1,1,10,...],
            [&quot;log&quot;,&quot;2021-11-26 11:53:29.093&quot;,4,1,1,1,10,...]
           ],
    &quot;rows&quot;:2
}
</code></pre>
<p><strong>Explain:</strong></p>
<ol>
<li><code>head</code>: column names.</li>
<li><code>column_data</code>:  <code>[&quot;created_time&quot;,9,8]</code> mean that column <code>create_time</code> have type <code>TIMESTAMP</code> taking <code>8</code> bytes.</li>
</ol>
<table><thead><tr><th>Type Code</th><th>Type Name</th></tr></thead><tbody>
<tr><td>1</td><td>BOOL</td></tr>
<tr><td>2</td><td>TINYINT</td></tr>
<tr><td>3</td><td>SMALLINT</td></tr>
<tr><td>4</td><td>INT</td></tr>
<tr><td>5</td><td>BIGINT</td></tr>
<tr><td>6</td><td>FLOAT</td></tr>
<tr><td>7</td><td>DOUBLE</td></tr>
<tr><td>8</td><td>BINARY</td></tr>
<tr><td>9</td><td>TIMESTAMP</td></tr>
<tr><td>10</td><td>NCHAR</td></tr>
</tbody></table>
<p>To avoid the long token, we will use -u option in the following examples.</p>
<h3 id="13-example-default-database"><a class="header" href="#13-example-default-database">1.3. Example: Default Database</a></h3>
<p>You can also specify default database in url.Show tables in database log:</p>
<pre><code class="language-bash">$ curl -u root:taosdata -d 'show tables' localhost:6041/rest/sql/log
{&quot;status&quot;:&quot;succ&quot;,&quot;head&quot;:[&quot;table_name&quot;,&quot;created_time&quot;,...
</code></pre>
<h3 id="14-example-insert-and-select"><a class="header" href="#14-example-insert-and-select">1.4. Example: Insert and Select</a></h3>
<pre><code class="language-bash">curl -u root:taosdata -d &quot;insert into meters values(now, 1.0) (now+1s, 1.1)&quot; localhost:6041/rest/sql/test_rest
</code></pre>
<pre><code class="language-json">{
    &quot;status&quot;:&quot;succ&quot;,
    &quot;head&quot;:[&quot;affected_rows&quot;],
    &quot;column_meta&quot;:[[&quot;affected_rows&quot;,4,4]],
    &quot;data&quot;:[[2]],
    &quot;rows&quot;:1
}
</code></pre>
<pre><code class="language-bash">curl -u root:taosdata -d &quot;select * from meters&quot; localhost:6041/rest/sql/test_rest
</code></pre>
<pre><code class="language-json">{
    &quot;status&quot;:&quot;succ&quot;,
    &quot;head&quot;:[&quot;ts&quot;,&quot;c1&quot;],
    &quot;column_meta&quot;:[[&quot;ts&quot;,9,8],[&quot;c1&quot;,7,8]],
    &quot;data&quot;:[[&quot;2021-12-10 14:45:28.922&quot;,1.000000000],
            [&quot;2021-12-10 14:45:29.922&quot;,1.100000000]],
    &quot;rows&quot;:2
}
</code></pre>
<h3 id="15-example-unix-time-format"><a class="header" href="#15-example-unix-time-format">1.5. Example: Unix Time Format</a></h3>
<p>Use unix time format. (a long value represent milliseconds since 1970).</p>
<p>Change <code>/rest/sql</code> to <code>/rest/sqlt</code>.</p>
<pre><code class="language-bash">curl -u root:taosdata -d &quot;select * from meters&quot; localhost:6041/rest/sqlt/test_rest
</code></pre>
<pre><code class="language-json">{
    &quot;status&quot;:&quot;succ&quot;,
    &quot;head&quot;:[&quot;ts&quot;,&quot;c1&quot;],
    &quot;column_meta&quot;:[[&quot;ts&quot;,9,8],[&quot;c1&quot;,7,8]],
    &quot;data&quot;:[[1639118728922,1.000000000],
            [1639118729922,1.100000000]],
    &quot;rows&quot;:2
}
</code></pre>
<h3 id="16-example-utc-time-format"><a class="header" href="#16-example-utc-time-format">1.6. Example: UTC Time Format</a></h3>
<p>Use UTC time format. Change <code>/rest/sql</code> to <code>/rest/sqlutc</code>.</p>
<pre><code class="language-bash">curl -u root:taosdata -d &quot;select * from meters&quot; localhost:6041/rest/sqlutc/test_rest
</code></pre>
<pre><code class="language-json">{
    &quot;status&quot;:&quot;succ&quot;,
    &quot;head&quot;:[&quot;ts&quot;,&quot;c1&quot;],
    &quot;column_meta&quot;:[[&quot;ts&quot;,9,8],[&quot;c1&quot;,7,8]],
     &quot;data&quot;:[[&quot;2021-12-10T14:45:28.922+0800&quot;,1.000000000],
            [&quot;2021-12-10T14:45:29.922+0800&quot;,1.100000000]],
     &quot;rows&quot;:2
}
</code></pre>
<h3 id="17-summary"><a class="header" href="#17-summary">1.7. Summary</a></h3>
<table><thead><tr><th>URL</th><th>Time Format</th></tr></thead><tbody>
<tr><td>/rest/sql</td><td>&quot;2021-12-10 14:45:29.922&quot;</td></tr>
<tr><td>/rest/sqlt</td><td>1639118728922</td></tr>
<tr><td>/rest/sqlutc</td><td>&quot;2021-12-10T14:45:28.922+0800&quot;</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-restful-api-with-java"><a class="header" href="#use-restful-api-with-java">Use Restful API with Java</a></h1>
<p>Java connector wrapped Restful API with JDBC API. You can treat it as another driver besides <code>jdbc:TAOS:*</code>, this is <code>jdbc:TAOS-RS:*</code>.</p>
<h2 id="1-get-started-15"><a class="header" href="#1-get-started-15">1. Get Started</a></h2>
<ol>
<li>Java: <code>1.8</code></li>
<li>taos-jdbcdriver: <code>2.0.34</code></li>
<li>TDengine: <code>2.2.1.3</code></li>
</ol>
<h2 id="11-pom-example"><a class="header" href="#11-pom-example">1.1. pom example</a></h2>
<pre><code class="language-xml">  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.taosdata.jdbc&lt;/groupId&gt;
      &lt;artifactId&gt;taos-jdbcdriver&lt;/artifactId&gt;
      &lt;version&gt;2.0.34&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.11&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
</code></pre>
<h2 id="12-example-get-connection"><a class="header" href="#12-example-get-connection">1.2 Example: Get Connection</a></h2>
<pre><code class="language-java">    @Test
    public void testGetResConnection() throws SQLException {
        String jdbcUrl = &quot;jdbc:TAOS-RS://localhost:6041/log?user=root&amp;password=taosdata&quot;;
        Connection conn = DriverManager.getConnection(jdbcUrl);
        conn.close();
    }
</code></pre>
<h2 id="12-example-create-statement"><a class="header" href="#12-example-create-statement">1.2. Example: Create Statement</a></h2>
<p>Test <code>Statement</code> and <code>PreparedStatement</code>.</p>
<pre><code class="language-java">    @Test
    public void testPreparedStatement() throws SQLException {
        String jdbcUrl = &quot;jdbc:TAOS-RS://localhost:6041?user=root&amp;password=taosdata&quot;;
        Connection conn = DriverManager.getConnection(jdbcUrl);
        Statement stmt = conn.createStatement();
        stmt.executeUpdate(&quot;drop database if exists test_rest&quot;);
        stmt.executeUpdate(&quot;create database test_rest&quot;);
        stmt.executeUpdate(&quot;use test_rest&quot;);
        stmt.executeUpdate(&quot;create table meters(ts timestamp, c1 double)&quot;);
        PreparedStatement pst = conn.prepareStatement(&quot;insert into meters values(?, ?)&quot;);
        pst.setLong(1, System.currentTimeMillis());
        pst.setDouble(2, 1.0);
        pst.addBatch();
        pst.setLong(1, System.currentTimeMillis() + 100);
        pst.setDouble(2, 2.0);
        pst.addBatch();
        pst.executeBatch();
        ResultSet rs = stmt.executeQuery(&quot;select * from meters&quot;);
        while (rs.next()) {
            System.out.println(rs.getTimestamp(1) + &quot; &quot; + rs.getDouble(2));
        }
        stmt.close();
        pst.close();
        conn.close();
    }
    //stdout
    //2021-12-10 17:11:12.006 1.0
    //2021-12-10 17:11:12.162 2.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-restful-api-with-nodejs"><a class="header" href="#use-restful-api-with-nodejs">Use Restful API with Node.js</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-restful-api-with-rust"><a class="header" href="#use-restful-api-with-rust">Use Restful API with Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appendix"><a class="header" href="#appendix">Appendix</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c-api-reference"><a class="header" href="#c-api-reference">C API Reference</a></h1>
<h2 id="tdengine-2300"><a class="header" href="#tdengine-2300">TDengine 2.3.0.0</a></h2>
<h3 id="basic"><a class="header" href="#basic">Basic</a></h3>
<ol>
<li><code>void taos_init()</code></li>
<li><code>void taos_cleanup()</code></li>
<li><code>int taos_options(TSDB_OPTION option, const void * arg, ...)</code></li>
<li><code>char *taos_get_client_info()</code></li>
<li><code>TAOS *taos_connect(const char *host, const char *user, const char *pass, const char *db, int port)</code></li>
<li><code>char *taos_get_server_info(TAOS *taos)</code></li>
<li><code>int taos_select_db(TAOS *taos, const char *db)</code></li>
<li><code>void taos_close(TAOS *taos)</code></li>
</ol>
<h3 id="synchronous-query-1"><a class="header" href="#synchronous-query-1">Synchronous Query</a></h3>
<ol>
<li><code>TAOS_RES* taos_query(TAOS *taos, const char *sql)</code></li>
<li><code>int taos_result_precision(TAOS_RES *res)</code></li>
<li><code>TAOS_ROW taos_fetch_row(TAOS_RES *res)</code></li>
<li><code>int taos_fetch_block(TAOS_RES *res, TAOS_ROW *rows)</code></li>
<li><code>int taos_num_fields(TAOS_RES *res) 和 int taos_field_count(TAOS_RES *res)</code></li>
<li><code>int* taos_fetch_lengths(TAOS_RES *res)</code></li>
<li><code>int taos_affected_rows(TAOS_RES *res)</code></li>
<li><code>TAOS_FIELD *taos_fetch_fields(TAOS_RES *res)</code></li>
<li><code>void taos_stop_query(TAOS_RES *res)</code></li>
<li><code>void taos_free_result(TAOS_RES *res)</code></li>
<li><code>char *taos_errstr(TAOS_RES *res)</code></li>
<li><code>int taos_errno(TAOS_RES *res)</code></li>
</ol>
<h3 id="asynchronous-query-1"><a class="header" href="#asynchronous-query-1">Asynchronous Query</a></h3>
<ol>
<li><code>void taos_query_a(TAOS *taos, const char *sql, void (*fp)(void *param, TAOS_RES *, int code), void *param)</code></li>
<li><code>void taos_fetch_rows_a(TAOS_RES *res, void (*fp)(void *param, TAOS_RES *, int numOfRows), void *param)</code></li>
</ol>
<h3 id="parameter-binding-1"><a class="header" href="#parameter-binding-1">Parameter Binding</a></h3>
<ol>
<li><code>TAOS_STMT* taos_stmt_init(TAOS *taos)</code></li>
<li><code>int taos_stmt_prepare(TAOS_STMT *stmt, const char *sql, unsigned long length)</code></li>
<li><code>int taos_stmt_bind_param(TAOS_STMT *stmt, TAOS_BIND *bind)</code></li>
<li><code>int taos_stmt_set_tbname(TAOS_STMT* stmt, const char* name)</code></li>
<li><code>int taos_stmt_set_tbname_tags(TAOS_STMT* stmt, const char* name, TAOS_BIND* tags)</code></li>
<li><code>int taos_stmt_bind_param_batch(TAOS_STMT* stmt, TAOS_MULTI_BIND* bind)</code></li>
<li><code>int taos_stmt_add_batch(TAOS_STMT *stmt)</code></li>
<li><code>int taos_stmt_execute(TAOS_STMT *stmt)</code></li>
<li><code>TAOS_RES* taos_stmt_use_result(TAOS_STMT *stmt)</code></li>
<li><code>int taos_stmt_close(TAOS_STMT *stmt)</code></li>
<li><code>char * taos_stmt_errstr(TAOS_STMT *stmt)</code></li>
</ol>
<h3 id="schemaless"><a class="header" href="#schemaless">Schemaless</a></h3>
<ol>
<li><code>TAOS_RES* taos_schemaless_insert(TAOS* taos, const char* lines[], int numLines, int protocol, int precision)</code></li>
</ol>
<h3 id="continuous-query-1"><a class="header" href="#continuous-query-1">Continuous Query</a></h3>
<ol>
<li><code>TAOS_STREAM *taos_open_stream(TAOS *taos, const char *sql, void (*fp)(void *param, TAOS_RES *, TAOS_ROW row), int64_t stime, void *param, void (*callback)(void *))</code></li>
<li><code>void taos_close_stream (TAOS_STREAM *tstr)</code></li>
</ol>
<h3 id="subscription-1"><a class="header" href="#subscription-1">Subscription</a></h3>
<ol>
<li><code>TAOS_SUB *taos_subscribe(TAOS* taos, int restart, const char* topic, const char *sql, TAOS_SUBSCRIBE_CALLBACK fp, void *param, int interval)</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="connector-feature-matrix"><a class="header" href="#connector-feature-matrix">Connector Feature Matrix</a></h1>
<h2 id="tdengine-2400"><a class="header" href="#tdengine-2400">TDengine 2.4.0.0</a></h2>
<table><thead><tr><th>Feature</th><th>C/C++</th><th>Java</th><th>Python</th><th>Go</th><th>C#</th><th>Node.js</th><th>Rust</th><th>Lua</th></tr></thead><tbody>
<tr><td>Plain SQL</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>Param Binding SQL</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>Async Query</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>Continuous Query</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>Subscription</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>Schemaless Writing</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>JSON Tag</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td>RESTful</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
</tbody></table>
<h2 id="tdengine-2300-1"><a class="header" href="#tdengine-2300-1">TDengine 2.3.0.0</a></h2>
<table><thead><tr><th>API Category</th><th>C Interface</th><th>Java (2.0.36)</th><th>Python</th><th>Go</th><th>C#</th><th>NodeJS</th><th>Rust</th><th>lua</th></tr></thead><tbody>
<tr><td>fundamental</td><td>taos_init()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_cleanup()</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_options()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_set_config()</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_connect()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_connect_auth()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_close()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_data_type()</td><td>✗</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td>stmt(bind_paramter)</td><td>taos_stmt_init()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_prepare()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_set_tbname_tags()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_set_tbname()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_set_sub_tbname()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_is_insert()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_num_params()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_get_param()</td><td>✗</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_bind_param()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_bind_param_batch()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_bind_single_param_batch()</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_add_batch()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_execute()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_affected_rows()</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_use_result()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_close()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_stmt_errstr()</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td></tr>
<tr><td>sql</td><td>taos_query()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_fetch_row()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_result_precision()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_free_result()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_field_count()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_num_fields()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_affected_rows()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_fetch_fields()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_select_db()</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_print_row()</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_stop_query()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_is_null()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_is_update_query()</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_fetch_block()</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_fetch_lengths()</td><td>✓</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td></tr>
<tr><td></td><td>taos_validate_sql()</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_reset_current_db()</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td>info</td><td>taos_get_server_info()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_get_client_info()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_errstr()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td></td><td>taos_errno()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr>
<tr><td>async sql</td><td>taos_query_a()</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td></tr>
<tr><td></td><td>taos_fetch_rows_a()</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td>subscribe</td><td>taos_subscribe()</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_consume()</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td></td><td>taos_unsubscribe()</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td></tr>
<tr><td>stream</td><td>taos_open_stream()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td></tr>
<tr><td></td><td>taos_close_stream()</td><td>✗</td><td>✓</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>✓</td></tr>
<tr><td>misc</td><td>taos_load_table_info()</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td></tr>
<tr><td>schemaless</td><td>taos_schemaless_insert()</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td></tr>
<tr><td>JSON Tag</td><td></td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✗</td></tr>
<tr><td>RESTful</td><td></td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>✓</td><td>✓</td><td>✗</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="troubleshooting-one"><a class="header" href="#troubleshooting-one">Troubleshooting One</a></h1>
<ul>
<li>
<p>&quot;Invalid app version&quot;.</p>
<ul>
<li>Solution: Try to reinstall the client.</li>
<li>Reproduce
<ul>
<li>Install client version 2.2.1.3 on windows</li>
<li>Rename C:/TDengine to C:/TDengine-2.2.1.3</li>
<li>Install client version 2.2.2.0</li>
<li>Rename C:/TDengine to C:/TDengine-2.2.2.0</li>
<li>Rename C:/TDengine-2.2.1.3 back to C:/TDengine</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Create connection is ok, but create database error.</p>
<ul>
<li>Server 2.2.1.3
<ul>
<li>Solution
<ul>
<li>If you start TDengine in wsl or docker, try add  <code>rpcForceTcp 1</code> in client's taos.cfg </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
